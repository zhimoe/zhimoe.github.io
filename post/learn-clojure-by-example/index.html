<!doctype html><html lang=zh dir=zh><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>通过例子学习Clojure - zhimoe</title><meta name=keywords content="读书,代码,架构,JVM,Java,Kotlin,Python,Rust"><meta name=author content="zhimoe"><meta property="og:title" content="通过例子学习Clojure"><meta property="og:site_name" content="zhimoe"><meta property="og:image" content="/img/author.jpg"><meta name=title content="通过例子学习Clojure - zhimoe"><meta name=description content="Captain your own Ship."><link rel="shortcut icon" href=https://zhimoe.github.io/img/favicon.ico><link rel=apple-touch-icon href=https://zhimoe.github.io/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=https://zhimoe.github.io/img/apple-touch-icon.png><link href=https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css><link href=https://cdn.bootcdn.net/ajax/libs/imageviewer/1.1.0/viewer.min.css rel=stylesheet><link href="https://zhimoe.github.io/css/main.css?v=20230708" rel=stylesheet type=text/css><link href=https://zhimoe.github.io/css/syntax.css rel=stylesheet type=text/css><script async src="https://www.googletagmanager.com/gtag/js?id=G-CJJZFN2DZR"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CJJZFN2DZR")</script></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-Hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button style=opacity:1;top:0><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class="site-meta custom-logo"><div class=custom-logo-site-title><a href=https://zhimoe.github.io/ class=brand rel=start><span class=logo-line-before><i></i></span>
<span class=site-title>zhimoe</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>Captain your own Ship.</p></div><div class=site-nav-right><div class="toggle popup-trigger" style=opacity:1;top:0><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=https://zhimoe.github.io/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class=menu-item><a href=https://zhimoe.github.io/post/ rel=section><i class="menu-item-icon fa fa-fw fa-list-alt"></i><br>归档</a></li><li class=menu-item><a href=https://zhimoe.github.io/categories/%E7%BC%96%E7%A8%8B/ rel=section><i class="menu-item-icon fa fa-fw fa-wpexplorer"></i><br>编程</a></li><li class=menu-item><a href=https://zhimoe.github.io/categories/%E7%BF%BB%E8%AF%91/ rel=section><i class="menu-item-icon fa fa-fw fa-language"></i><br>翻译</a></li><li class=menu-item><a href=https://zhimoe.github.io/categories/%E9%9A%8F%E6%83%B3/ rel=section><i class="menu-item-icon fa fa-fw fa-bathtub"></i><br>随想</a></li><li class=menu-item><a href=https://zhimoe.github.io/about/ rel=section><i class="menu-item-icon fa fa-fw fa-grav"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><div class=search-icon><i class="fa fa-search"></i></div><div class=local-search-input-wrapper><input autocomplete=off placeholder=搜索关键字... spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div><div class=popup-btn-close><i class="fa fa-times-circle"></i></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href=https://zhimoe.github.io/post/learn-clojure-by-example/ itemprop=url>通过例子学习Clojure</a></h1><div class=post-meta><span class=post-time><time itemprop=dateCreated datetime=2016-03-22T13:04:35+08:00 content="2019-05-13">2019-05-13</time></span>
<span class=post-category>&nbsp; | &nbsp;
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a class=post-category-list-link href=https://zhimoe.github.io/categories/%E7%BC%96%E7%A8%8B itemprop=url rel=index style=text-decoration:underline><span itemprop=name>编程</span></a>
&nbsp;</span></span></div></header><div class=post-body itemprop=articleBody><p>这份笔记试图打造最强的clojure小抄,keep refactoring it&mldr;</p><h2 id=clojure-入门>clojure 入门</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure><span style=display:flex><span>(<span style=color:#a90d91>ns </span><span style=color:#000>clj-notes.core</span>
</span></span><span style=display:flex><span>  (<span style=color:#c41a16>:gen-class</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;:gen-class generate java class file</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Parameter is variable in the declaration of function.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Argument is the actual value of this variable that gets passed to function.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;install leiningen:</span>
</span></span><span style=display:flex><span><span style=color:#177500>;put lein.bat in your PATH</span>
</span></span><span style=display:flex><span><span style=color:#177500>;open cmder,run: lein repl</span>
</span></span><span style=display:flex><span><span style=color:#177500>;start repl,use exit,(exit),(quit) or ctrl+d to quit repl</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;hello clojure&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Symbols are used to bind names to values</span>
</span></span><span style=display:flex><span><span style=color:#177500>;&#39; will prevent a form from being evaluated</span>
</span></span><span style=display:flex><span><span style=color:#177500>;&#39;() same as (quote ())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;def global variable</span>
</span></span><span style=display:flex><span><span style=color:#177500>;let local variable binding</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>object</span> <span style=color:#c41a16>&#34;light&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span><span style=color:#000>object</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>x</span> <span style=color:#1c01ce>10</span>
</span></span><span style=display:flex><span>      <span style=color:#000>y</span> <span style=color:#1c01ce>20</span>
</span></span><span style=display:flex><span>      <span style=color:#000>z</span> <span style=color:#1c01ce>30</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>+ </span><span style=color:#000>x</span> <span style=color:#000>y</span> <span style=color:#000>z</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;=&gt; 60</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;data collection</span>
</span></span><span style=display:flex><span><span style=color:#177500>;seq is abstract for list vector array</span>
</span></span><span style=display:flex><span><span style=color:#177500>;map</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>dict</span> {<span style=color:#c41a16>:k1</span> <span style=color:#c41a16>&#34;v1&#34;</span> <span style=color:#c41a16>:k2</span> <span style=color:#c41a16>&#34;v2&#34;</span>})
</span></span><span style=display:flex><span><span style=color:#177500>;keyword as function</span>
</span></span><span style=display:flex><span>(<span style=color:#c41a16>:k1</span> <span style=color:#000>dict</span>)                                                  <span style=color:#177500>;return v1</span>
</span></span><span style=display:flex><span><span style=color:#177500>;map as function</span>
</span></span><span style=display:flex><span>(<span style=color:#000>dict</span> <span style=color:#c41a16>:k1</span>)                                                  <span style=color:#177500>;return v1</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>v</span> (<span style=color:#000>dict</span> <span style=color:#c41a16>:k1</span>)]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>v</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;also you can use get on seq or map</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>get </span>{<span style=color:#c41a16>:a</span> <span style=color:#1c01ce>1</span> <span style=color:#c41a16>:b</span> <span style=color:#1c01ce>2</span>} <span style=color:#c41a16>:b</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;=&gt; 2</span>
</span></span><span style=display:flex><span><span style=color:#177500>;clojure.core/seq is a function that produces a sequence over the given argument. </span>
</span></span><span style=display:flex><span><span style=color:#177500>;Data types that clojure.core/seq can produce a sequence over are called seqable:</span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Clojure collections</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java maps</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All iterable types (types that implement java.util.Iterable)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java collections (java.util.Set, java.util.List, etc)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java arrays</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All types that implement java.lang.CharSequence interface, including Java strings</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All types that implement clojure.lang.Seqable interface</span>
</span></span><span style=display:flex><span><span style=color:#177500>;nil</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;function for seq or collection</span>
</span></span><span style=display:flex><span><span style=color:#177500>;=</span>
</span></span><span style=display:flex><span><span style=color:#177500>;count</span>
</span></span><span style=display:flex><span><span style=color:#177500>;conj</span>
</span></span><span style=display:flex><span><span style=color:#177500>;empty</span>
</span></span><span style=display:flex><span><span style=color:#177500>;seq</span>
</span></span><span style=display:flex><span><span style=color:#177500>;first</span>
</span></span><span style=display:flex><span><span style=color:#177500>;rest</span>
</span></span><span style=display:flex><span><span style=color:#177500>;next</span>
</span></span><span style=display:flex><span><span style=color:#177500>;count</span>
</span></span><span style=display:flex><span><span style=color:#177500>;counted?</span>
</span></span><span style=display:flex><span><span style=color:#177500>;conj</span>
</span></span><span style=display:flex><span><span style=color:#177500>;get</span>
</span></span><span style=display:flex><span><span style=color:#177500>;assoc</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;defn 定义函数</span>
</span></span><span style=display:flex><span><span style=color:#177500>;defn- 定义ns内私有函数</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>f</span>
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;the second line is doc-string&#34;</span>
</span></span><span style=display:flex><span>  {<span style=color:#c41a16>:added</span>  <span style=color:#c41a16>&#34;1.2&#34;</span>                                            <span style=color:#177500>;this is attr-map</span>
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:static</span> <span style=color:#000>true</span>}
</span></span><span style=display:flex><span>  [<span style=color:#000>param</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>print </span><span style=color:#c41a16>&#34;hello &#34;</span> <span style=color:#000>param</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>meta </span>(<span style=color:#a90d91>var </span><span style=color:#000>f</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;#&#39; is the reader macro for var and works the exactly same</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>meta </span><span style=color:#000>#</span><span style=color:#c41a16>&#39;f</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;fn create a function</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>f</span> (<span style=color:#a90d91>fn </span>[] (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;this is from fn function&#34;</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;#() is the shortcut for fn</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>plus-one</span> <span style=color:#000>#</span>(<span style=color:#a90d91>+ </span><span style=color:#1c01ce>1</span> <span style=color:#000>%</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;% will be replaced with arguments passed to the function</span>
</span></span><span style=display:flex><span><span style=color:#177500>;%1 is for the first argument, %2 is for the second and so on</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>des</span>
</span></span><span style=display:flex><span>  [{<span style=color:#000>k1</span> <span style=color:#c41a16>:k1</span>}]                                                <span style=color:#177500>;get :k1 value from argument (map) and binding it to k1(parameter)</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;destructing in map&#34;</span> <span style=color:#000>k1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>des</span> <span style=color:#000>dict</span>)                                                  <span style=color:#177500>;destructing in map v1</span>
</span></span><span style=display:flex><span><span style=color:#177500>;key don&#39;t have to be keyword</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-of</span>
</span></span><span style=display:flex><span>  [{<span style=color:#000>currency</span> <span style=color:#c41a16>&#34;currency&#34;</span>}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-of</span>
</span></span><span style=display:flex><span>  [{<span style=color:#000>currency</span> <span style=color:#c41a16>&#39;currency</span>}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;if want to destructing multi key,use :keys, in this case,parameter name(currency amount) </span>
</span></span><span style=display:flex><span><span style=color:#177500>;must same as arguments&#39;s keys(:currency :amount),can not use string as key</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-of</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:keys</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>]}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>* </span><span style=color:#000>currency</span> <span style=color:#000>amount</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>currency-of</span> {<span style=color:#c41a16>:currency</span> <span style=color:#c41a16>&#34;RMB&#34;</span> <span style=color:#c41a16>:amount</span> <span style=color:#1c01ce>100000</span>})              <span style=color:#177500>;ok</span>
</span></span><span style=display:flex><span>(<span style=color:#000>currency-of</span> {<span style=color:#c41a16>&#34;currency&#34;</span> <span style=color:#c41a16>&#34;RMB&#34;</span> <span style=color:#c41a16>&#34;amount&#34;</span> <span style=color:#1c01ce>100000</span>})            <span style=color:#177500>;currency will be nil,you will need use :strs or syms</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-strs</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:strs</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>]}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>currency-strs</span> {<span style=color:#c41a16>&#34;currency&#34;</span> <span style=color:#c41a16>&#34;RMB&#34;</span> <span style=color:#c41a16>&#34;amount&#34;</span> <span style=color:#1c01ce>100000</span>})          <span style=color:#177500>;ok</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-syms</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:syms</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>]}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>currency-syms</span> {<span style=color:#c41a16>&#39;currency</span> <span style=color:#c41a16>&#34;CNY&#34;</span> <span style=color:#c41a16>&#39;amount</span> <span style=color:#1c01ce>100000</span>})            <span style=color:#177500>;ok</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use :or to give a default value for parameter</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-or</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:keys</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>] <span style=color:#c41a16>:or</span> {<span style=color:#000>currency</span> <span style=color:#c41a16>&#34;USD&#34;</span>}}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>currency-or</span> {<span style=color:#c41a16>:amount</span> <span style=color:#1c01ce>100000</span>})                              <span style=color:#177500>;=&gt; &#34;USD&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use &amp; for Variadic Functions parameters</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>log</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>message</span> <span style=color:#000>&amp;</span> <span style=color:#000>args</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;args: &#34;</span> <span style=color:#000>args</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;named params , achieved by Variadic Functions destructing</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>job-info</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>&amp;</span> {<span style=color:#c41a16>:keys</span> [<span style=color:#a90d91>name </span><span style=color:#000>job</span> <span style=color:#000>income</span>] <span style=color:#c41a16>:or</span> {<span style=color:#000>job</span> <span style=color:#c41a16>&#34;unemployed&#34;</span> <span style=color:#000>income</span> <span style=color:#c41a16>&#34;$0.00&#34;</span>}}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>if </span><span style=color:#000>name</span>
</span></span><span style=display:flex><span>    [<span style=color:#a90d91>name </span><span style=color:#000>job</span> <span style=color:#000>income</span>]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;No name specified&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;cation! arguments to job-info is not a map</span>
</span></span><span style=display:flex><span>(<span style=color:#000>job-info</span> <span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Robert&#34;</span> <span style=color:#c41a16>:job</span> <span style=color:#c41a16>&#34;Engineer&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;[&#34;Robert&#34; &#34;Engineer&#34; &#34;$0.00&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Without the use of a variadic argument list, </span>
</span></span><span style=display:flex><span><span style=color:#177500>;you would have to call the function with a single map argument such as</span>
</span></span><span style=display:flex><span>(<span style=color:#000>job-info</span> {<span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Robert&#34;</span> <span style=color:#c41a16>:job</span> <span style=color:#c41a16>&#34;Engineer&#34;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;destructuring example</span>
</span></span><span style=display:flex><span><span style=color:#177500>;https://gist.github.com/john2x/e1dca953548bfdfb9844</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-vec</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span> <span style=color:#000>d</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span> <span style=color:#000>d</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;1 2 3 nil</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>&amp;</span> <span style=color:#000>the-rest</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;a=&#34;</span> <span style=color:#000>a</span> <span style=color:#c41a16>&#34;b=&#34;</span> <span style=color:#000>b</span> <span style=color:#c41a16>&#34;the-rest=&#34;</span> <span style=color:#000>the-rest</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;a= 1 b= 2 the-rest= (3)</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#c41a16>:as</span> <span style=color:#000>all</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;[1 2 3]</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#c41a16>:as</span> <span style=color:#000>all</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;1 [1 2 3]</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>&amp;</span> <span style=color:#000>the-rest</span> <span style=color:#c41a16>:as</span> <span style=color:#000>all</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>the-rest</span> <span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;1 2 (3) [1 2 3]</span>
</span></span><span style=display:flex><span><span style=color:#177500>;note: &amp; the-rest convert vector to list,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;but :as preserves them (as a list, or as a vector)</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-vec</span> [<span style=color:#c41a16>&#34;first&#34;</span> <span style=color:#c41a16>&#34;second&#34;</span>])
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#1c01ce>0</span> <span style=color:#000>b</span> <span style=color:#1c01ce>1</span>} <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span>))                                            <span style=color:#177500>;=&gt; &#34;first second&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;optional arguments to functions</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>foo</span> [<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>&amp;</span> <span style=color:#000>more-args</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>more-args</span>))
</span></span><span style=display:flex><span>(<span style=color:#000>foo</span> <span style=color:#c41a16>:a</span> <span style=color:#c41a16>:b</span>)                                                 <span style=color:#177500>;; =&gt; :a :b nil</span>
</span></span><span style=display:flex><span>(<span style=color:#000>foo</span> <span style=color:#c41a16>:a</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>:x</span>)                                              <span style=color:#177500>;; =&gt; :a :b (:x)</span>
</span></span><span style=display:flex><span>(<span style=color:#000>foo</span> <span style=color:#c41a16>:a</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>:x</span> <span style=color:#c41a16>:y</span> <span style=color:#c41a16>:z</span>)                                        <span style=color:#177500>;; =&gt; :a :b (:x :y :z)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;map destructuring</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-hashmap</span> {<span style=color:#c41a16>:a</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>&#34;B&#34;</span> <span style=color:#c41a16>:c</span> <span style=color:#c41a16>&#34;C&#34;</span> <span style=color:#c41a16>:d</span> <span style=color:#c41a16>&#34;D&#34;</span>})
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-nested-hashmap</span> {<span style=color:#c41a16>:a</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>&#34;B&#34;</span> <span style=color:#c41a16>:c</span> <span style=color:#c41a16>&#34;C&#34;</span> <span style=color:#c41a16>:d</span> <span style=color:#c41a16>&#34;D&#34;</span> <span style=color:#c41a16>:q</span> {<span style=color:#c41a16>:x</span> <span style=color:#c41a16>&#34;X&#34;</span> <span style=color:#c41a16>:y</span> <span style=color:#c41a16>&#34;Y&#34;</span> <span style=color:#c41a16>:z</span> <span style=color:#c41a16>&#34;Z&#34;</span>}})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#c41a16>:a</span> <span style=color:#000>d</span> <span style=color:#c41a16>:d</span>} <span style=color:#000>my-hashmap</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>d</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;; =&gt; A D</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#c41a16>:a</span>, <span style=color:#000>b</span> <span style=color:#c41a16>:b</span>, {<span style=color:#000>x</span> <span style=color:#c41a16>:x</span>, <span style=color:#000>y</span> <span style=color:#c41a16>:y</span>} <span style=color:#c41a16>:q</span>} <span style=color:#000>my-nested-hashmap</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>x</span> <span style=color:#000>y</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;; =&gt; A B X Y</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#c41a16>:a</span>, <span style=color:#000>b</span> <span style=color:#c41a16>:b</span>, <span style=color:#000>not-found</span> <span style=color:#c41a16>:not-found</span>, <span style=color:#c41a16>:or</span> {<span style=color:#000>not-found</span> <span style=color:#c41a16>&#34;:)&#34;</span>}, <span style=color:#c41a16>:as</span> <span style=color:#000>all</span>} <span style=color:#000>my-hashmap</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>not-found</span> <span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;; =&gt; A B :) {:a A :b B :c C :d D}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;!!! There is no &amp; rest for maps.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;everything but false and nil evaluates to true in Clojure.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;:as bind entire map to param</span>
</span></span><span style=display:flex><span><span style=color:#177500>;See https://github.com/ring-clojure/ring/wiki/File-Uploads for explanation</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>file-handler</span>
</span></span><span style=display:flex><span>  <span style=color:#177500>;表示入参是一个map,里面有:params这个key,将:params</span>
</span></span><span style=display:flex><span>  <span style=color:#177500>;[{{{tempfile :tempfile filename :filename} &#34;file&#34;} :params :as request}]</span>
</span></span><span style=display:flex><span>  [{{{<span style=color:#000>tempfile</span> <span style=color:#c41a16>:tempfile</span> <span style=color:#000>filename</span> <span style=color:#c41a16>:filename</span>} <span style=color:#c41a16>&#34;file&#34;</span>} <span style=color:#c41a16>:params</span> <span style=color:#c41a16>:as</span> <span style=color:#000>request</span>}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>request</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>n</span> (<span style=color:#000>num-lines</span> <span style=color:#000>tempfile</span>)]
</span></span><span style=display:flex><span>    (<span style=color:#000>response</span> (<span style=color:#a90d91>str </span><span style=color:#c41a16>&#34;File &#34;</span> <span style=color:#000>filename</span> <span style=color:#c41a16>&#34; has &#34;</span> <span style=color:#000>n</span> <span style=color:#c41a16>&#34; lines &#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;a simple example</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>first-first</span>
</span></span><span style=display:flex><span>  [[[<span style=color:#000>i</span> <span style=color:#000>_</span>] <span style=color:#000>_</span>]]
</span></span><span style=display:flex><span>  <span style=color:#000>i</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>first-first</span> [[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span>] [<span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span>]])
</span></span><span style=display:flex><span><span style=color:#177500>;return 1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;(defn name doc-string? attr-map? [params*] prepost-map? body)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(defn name doc-string? attr-map? ([params*] prepost-map? body) + attr-map?)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;function can have params type hint</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>round</span>
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;^double here is type hint&#34;</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>^</span><span style=color:#a90d91>double </span><span style=color:#000>d</span> <span style=color:#000>^</span><span style=color:#a90d91>long </span><span style=color:#000>precision</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>factor</span> (<span style=color:#000>Math/pow</span> <span style=color:#1c01ce>10</span> <span style=color:#000>precision</span>)]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>/ </span>(<span style=color:#000>Math/floor</span> (<span style=color:#a90d91>* </span><span style=color:#000>d</span> <span style=color:#000>factor</span>)) <span style=color:#000>factor</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;不定长参数</span>
</span></span><span style=display:flex><span><span style=color:#177500>;重载函数</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>bar</span>
</span></span><span style=display:flex><span>  ([<span style=color:#000>a</span> <span style=color:#000>b</span>] (<span style=color:#000>bar</span> <span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#1c01ce>100</span>))
</span></span><span style=display:flex><span>  ([<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span>] (<span style=color:#a90d91>* </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>bar</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>bar</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span> <span style=color:#1c01ce>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>keyworded-map</span> [<span style=color:#000>&amp;</span> {<span style=color:#c41a16>:keys</span> [<span style=color:#000>function</span> <span style=color:#000>sequence</span>]}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>map </span><span style=color:#000>function</span> <span style=color:#000>sequence</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>keyworded-map</span> <span style=color:#c41a16>:sequence</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>] <span style=color:#c41a16>:function</span> <span style=color:#000>#</span>(<span style=color:#a90d91>+ </span><span style=color:#000>%</span> <span style=color:#1c01ce>2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;trampoline</span>
</span></span><span style=display:flex><span><span style=color:#177500>;trampoline</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;namespace</span>
</span></span><span style=display:flex><span><span style=color:#177500>;create-ns create a namespace</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>create-ns </span><span style=color:#c41a16>&#39;zhi.moe.clj</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;in-ns move to a namespace</span>
</span></span><span style=display:flex><span><span style=color:#177500>;require loads a namespace and</span>
</span></span><span style=display:flex><span><span style=color:#177500>;refer refers the namespace.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;To do these at once, you can use use</span>
</span></span><span style=display:flex><span>(<span style=color:#000>require</span> <span style=color:#c41a16>&#39;clojure.by.example</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>clojure.by.example/favorite-language</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>use</span> <span style=color:#c41a16>&#39;clojure.by.example</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;you can rename namespace</span>
</span></span><span style=display:flex><span>(<span style=color:#000>require</span> <span style=color:#000>&#39;</span>[<span style=color:#000>clojure.by.example</span> <span style=color:#c41a16>:as</span> <span style=color:#000>temp-ns</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;ns macro creates a new namespace and gives you an opportunity to load other namespaces at the creation time</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;import java class</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>import </span><span style=color:#000>java.util.Date</span>)
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span>(<span style=color:#a90d91>str </span> (<span style=color:#a90d91>new </span><span style=color:#000>Date</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;Wed Jul 24 22:55:24 CST 2019</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;boolean</span>
</span></span><span style=display:flex><span><span style=color:#177500>;In Clojure, everything except false and nil are true.</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>if </span><span style=color:#1c01ce>1</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;it is true&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;will never print&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;if</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>if </span><span style=color:#000>true</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;executed when true&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;executed when false&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use do to execute multi expressions</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>if </span><span style=color:#000>true</span>
</span></span><span style=display:flex><span>  (<span style=color:#000>do</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;one&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;two&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;if-let:</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>positive-number</span> [<span style=color:#000>numbers</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>if-let </span>[<span style=color:#000>pos-nums</span> (<span style=color:#000>not-empty</span> (<span style=color:#a90d91>filter pos? </span><span style=color:#000>numbers</span>))]
</span></span><span style=display:flex><span>    <span style=color:#000>pos-nums</span>
</span></span><span style=display:flex><span>    <span style=color:#c41a16>&#34;no positive numbers&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;when when-let case cond condp</span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>cond-test</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>n</span>]
</span></span><span style=display:flex><span>  (<span style=color:#000>cond</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>= </span><span style=color:#000>n</span> <span style=color:#1c01ce>1</span>) <span style=color:#c41a16>&#34;n is 1&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>and </span>(<span style=color:#a90d91>&gt; </span><span style=color:#000>n</span> <span style=color:#1c01ce>3</span>) (<span style=color:#a90d91>&lt; </span><span style=color:#000>n</span> <span style=color:#1c01ce>10</span>)) <span style=color:#c41a16>&#34;n is over 3 and under 10&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c41a16>:else</span> <span style=color:#c41a16>&#34;n is other&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>cond-test</span> <span style=color:#1c01ce>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;string</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#a90d91>first </span><span style=color:#c41a16>&#34;Hirokuni&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a90d91>last </span><span style=color:#c41a16>&#34;Kim&#34;</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>str </span><span style=color:#c41a16>&#34;My name is &#34;</span> <span style=color:#a90d91>first </span><span style=color:#c41a16>&#34; &#34;</span> <span style=color:#000>last</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;format</span>
</span></span><span style=display:flex><span>(<span style=color:#000>format</span> <span style=color:#c41a16>&#34;My name is %s %s&#34;</span> <span style=color:#c41a16>&#34;Hirokuni&#34;</span> <span style=color:#c41a16>&#34;Kim&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;power function</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>power</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>x</span> <span style=color:#000>n</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>reduce * </span>(<span style=color:#a90d91>repeat </span><span style=color:#000>n</span> <span style=color:#000>x</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;bigint,N is a literal for bigint</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>+ </span><span style=color:#1c01ce>9223372036854775807</span> <span style=color:#1c01ce>10</span><span style=color:#000>N</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;list conj nth count</span>
</span></span><span style=display:flex><span><span style=color:#000>&#39;</span>(<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;vector conj nth count .indexOf</span>
</span></span><span style=display:flex><span>[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>]
</span></span><span style=display:flex><span>(<span style=color:#000>.indexOf</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>] <span style=color:#1c01ce>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>count </span>[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;set conj nth count disj sort contains? subset? superset?</span>
</span></span><span style=display:flex><span><span style=color:#000>#</span>{<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;map assoc merge keys vals</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>os</span> {<span style=color:#c41a16>:Apple</span> <span style=color:#c41a16>&#34;Mac&#34;</span> <span style=color:#c41a16>:Microsoft</span> <span style=color:#c41a16>&#34;Windows&#34;</span>}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>get </span><span style=color:#000>os</span> <span style=color:#c41a16>:Apple</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>assoc </span>{<span style=color:#c41a16>:Apple</span> <span style=color:#c41a16>&#34;Mac&#34;</span> <span style=color:#c41a16>:Microsoft</span> <span style=color:#c41a16>&#34;Windows&#34;</span>} <span style=color:#c41a16>:Commodore</span> <span style=color:#c41a16>&#34;Amiga&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Sequences are data types that abstract all more concrete data types with unified functions. </span>
</span></span><span style=display:flex><span><span style=color:#177500>;These functions are called the Seq library in Clojure.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;seq first rest cons concat map reduce into</span>
</span></span><span style=display:flex><span><span style=color:#177500>;To add an element to the head of sequence, use cons.</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>cons </span><span style=color:#1c01ce>4</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>(<span style=color:#a90d91>into </span>[] <span style=color:#000>`</span>(<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>reverse </span>[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;get a sequence of infinite integers with iterate. Be careful, </span>
</span></span><span style=display:flex><span><span style=color:#177500>;though. Running this example will freeze your terminal since the evaluation of this expression never returns.</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>iterate</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>range</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>repeatedly</span> <span style=color:#1c01ce>5</span> (<span style=color:#a90d91>fn </span>[] (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;hi!&#34;</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;for each</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doseq </span>[<span style=color:#000>animal</span> [<span style=color:#c41a16>&#34;cat&#34;</span> <span style=color:#c41a16>&#34;dog&#34;</span> <span style=color:#c41a16>&#34;horse&#34;</span>]] (<span style=color:#a90d91>println </span><span style=color:#000>animal</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>take </span><span style=color:#1c01ce>5</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>0</span> <span style=color:#1c01ce>100</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>take-while neg? </span>[<span style=color:#1c01ce>-3</span> <span style=color:#1c01ce>-2</span> <span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>0</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;drop will remove the first n elements</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>drop </span><span style=color:#1c01ce>5</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>0</span> <span style=color:#1c01ce>10</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>drop-while neg? </span>[<span style=color:#1c01ce>-3</span> <span style=color:#1c01ce>-2</span> <span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>0</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;(0 1 2 3)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>remove pos? </span>[<span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>-2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;(-1 -2)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>filter pos? </span>[<span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>(<span style=color:#000>partition-by</span> <span style=color:#000>#</span>(<span style=color:#a90d91>&lt; </span><span style=color:#1c01ce>3</span> <span style=color:#000>%</span>) [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span>])
</span></span><span style=display:flex><span>(<span style=color:#000>group-by</span> <span style=color:#000>#</span>(<span style=color:#a90d91>&lt; </span><span style=color:#1c01ce>3</span> <span style=color:#000>%</span>) [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span>(<span style=color:#a90d91>take </span><span style=color:#1c01ce>5</span> (<span style=color:#a90d91>iterate inc </span><span style=color:#1c01ce>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;for compression</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> <span style=color:#000>&#39;</span>(<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>)]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>+ </span><span style=color:#1c01ce>10</span> <span style=color:#000>x</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>for</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;双重for 循环</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>10</span>)
</span></span><span style=display:flex><span>      <span style=color:#000>y</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>20</span>)
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:while</span> (<span style=color:#a90d91>&lt; </span><span style=color:#000>y</span> <span style=color:#000>x</span>)]
</span></span><span style=display:flex><span>  [<span style=color:#000>x</span> <span style=color:#000>y</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;&lt;==&gt; {x | x &gt;0}</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> <span style=color:#000>&#39;</span>(<span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span>)
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:when</span> (<span style=color:#a90d91>&gt; </span><span style=color:#000>x</span> <span style=color:#1c01ce>0</span>)]
</span></span><span style=display:flex><span>  <span style=color:#000>x</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> [<span style=color:#1c01ce>0</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span> <span style=color:#1c01ce>5</span>]
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:let</span> [<span style=color:#000>y</span> (<span style=color:#a90d91>* </span><span style=color:#000>x</span> <span style=color:#1c01ce>3</span>)]
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:when</span> (<span style=color:#000>even?</span> <span style=color:#000>y</span>)]
</span></span><span style=display:flex><span>  <span style=color:#000>y</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;meta data for function parameters</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>round</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>^</span><span style=color:#a90d91>double </span><span style=color:#000>d</span> <span style=color:#000>^</span><span style=color:#a90d91>long </span><span style=color:#000>precision</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>factor</span> (<span style=color:#000>Math/pow</span> <span style=color:#1c01ce>10</span> <span style=color:#000>precision</span>)]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>/ </span>(<span style=color:#000>Math/floor</span> (<span style=color:#a90d91>* </span><span style=color:#000>d</span> <span style=color:#000>factor</span>)) <span style=color:#000>factor</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;# is Dispatch character that tells the Clojure reader how to interpret the next character using a read table</span>
</span></span><span style=display:flex><span><span style=color:#177500>;set</span>
</span></span><span style=display:flex><span><span style=color:#000>#</span>{<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>}
</span></span><span style=display:flex><span><span style=color:#177500>;discard</span>
</span></span><span style=display:flex><span>{<span style=color:#c41a16>:a</span> <span style=color:#1c01ce>1</span>, <span style=color:#000>#</span><span style=color:#000>_#_</span><span style=color:#c41a16>:b</span> <span style=color:#1c01ce>2</span>, <span style=color:#c41a16>:c</span> <span style=color:#1c01ce>3</span>}
</span></span><span style=display:flex><span><span style=color:#177500>;regular expression</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>re-matches </span><span style=color:#000>#</span><span style=color:#c41a16>&#34;^test$&#34;</span> <span style=color:#c41a16>&#34;test&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;anonymous function</span>
</span></span><span style=display:flex><span><span style=color:#000>#</span>(<span style=color:#a90d91>println </span><span style=color:#000>%</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;var quote</span>
</span></span><span style=display:flex><span>(<span style=color:#000>read-string</span> <span style=color:#c41a16>&#34;#&#39;foo&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;symbolic values</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>/ </span><span style=color:#1c01ce>1.0</span> <span style=color:#1c01ce>0.0</span>)                                                 <span style=color:#177500>;##Inf</span>
</span></span><span style=display:flex><span><span style=color:#177500>;tagged literals</span>
</span></span><span style=display:flex><span>(<span style=color:#000>type</span> <span style=color:#000>#</span><span style=color:#000>inst</span> <span style=color:#c41a16>&#34;2014-05-19T19:12:37.925-00:00&#34;</span>)                <span style=color:#177500>;java.util.Date</span>
</span></span><span style=display:flex><span><span style=color:#177500>;meta</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>meta </span><span style=color:#000>#</span><span style=color:#c41a16>&#39;fn-name</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;reader conditionals </span>
</span></span><span style=display:flex><span><span style=color:#000>#</span><span style=color:#000>?</span>(<span style=color:#c41a16>:clj</span>     (<span style=color:#000>Clojure</span> <span style=color:#000>expression</span>)
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:cljs</span>    (<span style=color:#000>ClojureScript</span> <span style=color:#000>expression</span>)
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:cljr</span>    (<span style=color:#000>Clojure</span> <span style=color:#000>CLR</span> <span style=color:#000>expression</span>)
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:default</span> (<span style=color:#000>fallthrough</span> <span style=color:#000>expression</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;#?@ splicing reader conditional</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>build-list</span> []
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>list </span><span style=color:#000>#</span><span style=color:#000>?</span><span style=color:#000>@</span>(<span style=color:#c41a16>:clj</span>  [<span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span> <span style=color:#1c01ce>7</span> <span style=color:#1c01ce>8</span>]
</span></span><span style=display:flex><span>            <span style=color:#c41a16>:cljs</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span>])))                              <span style=color:#177500>;return [5 6 7 8] when run on clojure</span>
</span></span><span style=display:flex><span><span style=color:#177500>;#= allows the reader to evaluate an arbitrary form during read time</span>
</span></span><span style=display:flex><span>(<span style=color:#000>read-string</span> <span style=color:#c41a16>&#34;#=(+ 3 4)&#34;</span>)                                   <span style=color:#177500>;7</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Recursion</span>
</span></span><span style=display:flex><span><span style=color:#177500>;simple recursion</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>fibo</span>
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;this is recursion function&#34;</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>n</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>if </span>(<span style=color:#a90d91>or </span>(<span style=color:#a90d91>= </span><span style=color:#000>n</span> <span style=color:#1c01ce>0</span>) (<span style=color:#a90d91>= </span><span style=color:#000>n</span> <span style=color:#1c01ce>1</span>))
</span></span><span style=display:flex><span>    <span style=color:#000>n</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>+ </span>(<span style=color:#000>fibo</span> (<span style=color:#a90d91>- </span><span style=color:#000>n</span> <span style=color:#1c01ce>1</span>)) (<span style=color:#000>fibo</span> (<span style=color:#a90d91>- </span><span style=color:#000>n</span> <span style=color:#1c01ce>2</span>)))))
</span></span><span style=display:flex><span><span style=color:#177500>;do not do this!!! take a long time to finish</span>
</span></span><span style=display:flex><span>(<span style=color:#000>fibo</span> <span style=color:#1c01ce>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use recur</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>fibo-recur</span> [<span style=color:#000>iteration</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>fibo</span> (<span style=color:#a90d91>fn </span>[<span style=color:#000>one</span> <span style=color:#000>two</span> <span style=color:#000>n</span>]
</span></span><span style=display:flex><span>               (<span style=color:#a90d91>if </span>(<span style=color:#a90d91>= </span><span style=color:#000>iteration</span> <span style=color:#000>n</span>)
</span></span><span style=display:flex><span>                 <span style=color:#000>one</span>
</span></span><span style=display:flex><span>                 (<span style=color:#000>recur</span> <span style=color:#000>two</span> (<span style=color:#a90d91>+ </span><span style=color:#000>one</span> <span style=color:#000>two</span>) (<span style=color:#a90d91>inc </span><span style=color:#000>n</span>))))]
</span></span><span style=display:flex><span>    <span style=color:#177500>;recur re-binds it&#39;s arguments to new values and call the function with the new values</span>
</span></span><span style=display:flex><span>    <span style=color:#177500>;fibo is an inner function</span>
</span></span><span style=display:flex><span>    (<span style=color:#000>fibo</span> <span style=color:#1c01ce>0</span><span style=color:#000>N</span> <span style=color:#1c01ce>1</span><span style=color:#000>N</span> <span style=color:#1c01ce>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>fibo-recur</span> <span style=color:#1c01ce>1000</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;it is really fast</span>
</span></span><span style=display:flex><span><span style=color:#177500>;notes</span>
</span></span><span style=display:flex><span><span style=color:#177500>;with simple recursion, each recursive call creates a stack frame which is </span>
</span></span><span style=display:flex><span><span style=color:#177500>;a data to store the information of the called function on memory.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Doing deep recursion requires large memory for stack frames, but since it cannot, </span>
</span></span><span style=display:flex><span><span style=color:#177500>;we get StackOverflowError</span>
</span></span><span style=display:flex><span><span style=color:#177500>;尾递归</span>
</span></span><span style=display:flex><span><span style=color:#177500>;A function is tail recursive when the recursion is happening at the end of it&#39;s definition</span>
</span></span><span style=display:flex><span><span style=color:#177500>;In other words, a tail recursive function must return itself as it&#39;s returned value.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;When you use recur, it makes sure you are doing tail recursion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>loop</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;loop/recur is merely a friendly way to write recursion code.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All imperative loops can be converted to recursions and all recursions can be converted to loops,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;so Clojure chose recursions.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Although you can write code that looks like an imperative loop with loop/recur,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Clojure is doing recursion under the hood.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defmacro </span><span style=color:#000>unless</span> [<span style=color:#a90d91>test </span><span style=color:#000>then</span>]
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;Evaluates then when test evaluates to be falsey&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>list </span><span style=color:#c41a16>&#39;if</span> (<span style=color:#a90d91>list </span><span style=color:#c41a16>&#39;not</span> <span style=color:#000>test</span>)
</span></span><span style=display:flex><span>        <span style=color:#000>then</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>macroexpand </span><span style=color:#000>&#39;</span>(<span style=color:#000>unless</span> <span style=color:#000>false</span> (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;hi&#34;</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;&#39; quoting</span>
</span></span><span style=display:flex><span><span style=color:#177500>;` syntax-quoting returns the fully qualified namespace.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Using fully qualified namespace is very important in order to avoid name conflicts when defining macro.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;~ unquote</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>`</span>(<span style=color:#a90d91>+ </span><span style=color:#000>~</span>(<span style=color:#a90d91>list </span><span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;(clojure.core/+ (1 2 3))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>`</span>(<span style=color:#a90d91>+ </span><span style=color:#000>~@</span>(<span style=color:#a90d91>list </span><span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;(clojure.core/+ 1 2 3)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;The ~@ unquote splice works just like ~ unquote,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;except it expands a sequence and splice the contents of </span>
</span></span><span style=display:flex><span><span style=color:#177500>;the sequence into the enclosing syntax-quoted data structure</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;thread first macro</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>-&gt; </span>[]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>conj </span><span style=color:#1c01ce>1</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>conj </span><span style=color:#1c01ce>2</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>conj </span><span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;[1 2 3]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>first </span>(<span style=color:#000>.split</span> (<span style=color:#000>.replace</span> (<span style=color:#000>.toUpperCase</span> <span style=color:#c41a16>&#34;a b c d&#34;</span>) <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>&#34;X&#34;</span>) <span style=color:#c41a16>&#34; &#34;</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;&#34;X&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;;Perhaps easier to read:</span>
</span></span><span style=display:flex><span><span style=color:#177500>;-&gt; 后面是初始参数,第2行开始每一行是一个函数调用,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;且上一行的返回值会作为这一行第一个参数(这就是thread first)的first含义</span>
</span></span><span style=display:flex><span><span style=color:#177500>;这里的thread是管道的意思,而不是并发编程的线程</span>
</span></span><span style=display:flex><span><span style=color:#177500>;如果省略(),那么野生符号(bare symbol)和keyword都会当作一个函数调用,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;例如,这里的.toUpperCase是bare symbol,等效于(.toUpperCase ,,,)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;clojure中 逗号等于空白符,所以上面用,,,表示将会插入的参数(即&#34;a b c d&#34;)</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>-&gt; </span><span style=color:#c41a16>&#34;a b c d&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>.toUpperCase</span>
</span></span><span style=display:flex><span>    (<span style=color:#000>.replace</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>&#34;X&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#000>.split</span> <span style=color:#c41a16>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#000>first</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;same as follow, ,,, is equals whitespace</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>-&gt; </span><span style=color:#c41a16>&#34;a b c d&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#000>.toUpperCase</span>,,,)
</span></span><span style=display:flex><span>    (<span style=color:#000>.replace</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>&#34;X&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#000>.split</span> <span style=color:#c41a16>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#000>first</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;suppose a function</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>calculate</span> []
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>reduce + </span>(<span style=color:#a90d91>map </span><span style=color:#000>#</span>(<span style=color:#a90d91>* </span><span style=color:#000>%</span> <span style=color:#000>%</span>) (<span style=color:#a90d91>filter </span><span style=color:#000>odd?</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>10</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;same as</span>
</span></span><span style=display:flex><span><span style=color:#177500>;上一行的结果作为最后一个参数插入,这叫thread last</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>calculate*</span> []
</span></span><span style=display:flex><span>  (<span style=color:#000>-&gt;&gt;</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>10</span>)
</span></span><span style=display:flex><span>       (<span style=color:#a90d91>filter </span><span style=color:#000>odd?</span>,,,)
</span></span><span style=display:flex><span>       (<span style=color:#a90d91>map </span><span style=color:#000>#</span>(<span style=color:#a90d91>* </span><span style=color:#000>%</span> <span style=color:#000>%</span>),,,)
</span></span><span style=display:flex><span>       (<span style=color:#a90d91>reduce </span><span style=color:#000>+</span>,,,)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;如果想要指定每次插入的位置那么需要用 as-&gt;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;v是每一行的返回值的名称,这样你可以在下一行任意参数位置指定</span>
</span></span><span style=display:flex><span>(<span style=color:#000>as-&gt;</span> [<span style=color:#c41a16>:foo</span> <span style=color:#c41a16>:bar</span>] <span style=color:#000>v</span>
</span></span><span style=display:flex><span>      (<span style=color:#a90d91>map name </span><span style=color:#000>v</span>)
</span></span><span style=display:flex><span>      (<span style=color:#a90d91>first </span><span style=color:#000>v</span>)
</span></span><span style=display:flex><span>      (<span style=color:#000>.substring</span> <span style=color:#000>v</span> <span style=color:#1c01ce>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;destructing</span>
</span></span><span style=display:flex><span>({<span style=color:#c41a16>:keys</span> [<span style=color:#000>firstname</span> <span style=color:#000>lastname</span>] <span style=color:#c41a16>:as</span> <span style=color:#000>person</span>} {<span style=color:#c41a16>:firstname</span> <span style=color:#c41a16>&#34;John&#34;</span> <span style=color:#c41a16>:lastname</span> <span style=color:#c41a16>&#34;Smith&#34;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;future and deref</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>future-val</span> (<span style=color:#000>future</span> (<span style=color:#a90d91>inc </span><span style=color:#1c01ce>1</span>))]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span>(<span style=color:#a90d91>deref </span><span style=color:#000>future-val</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;deref == @</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>future-val</span> (<span style=color:#000>future</span> (<span style=color:#a90d91>inc </span><span style=color:#1c01ce>1</span>))]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>@</span><span style=color:#000>future-val</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-future</span> (<span style=color:#000>future</span> (<span style=color:#000>Thread/sleep</span> <span style=color:#1c01ce>5000</span>)))
</span></span><span style=display:flex><span>(<span style=color:#000>repeatedly</span> <span style=color:#1c01ce>6</span>
</span></span><span style=display:flex><span>            (<span style=color:#a90d91>fn </span>[]
</span></span><span style=display:flex><span>              (<span style=color:#a90d91>println </span>(<span style=color:#000>realized?</span> <span style=color:#000>my-future</span>))
</span></span><span style=display:flex><span>              (<span style=color:#000>Thread/sleep</span> <span style=color:#1c01ce>1000</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>future</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;promise</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-promise</span> (<span style=color:#000>promise</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;you define a promise</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>listen-and-callback</span> (<span style=color:#a90d91>fn </span>[]
</span></span><span style=display:flex><span>                           (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;Start listening...&#34;</span>)
</span></span><span style=display:flex><span>                           (<span style=color:#000>future</span> (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;Callback fired: &#34;</span> <span style=color:#000>@</span><span style=color:#000>my-promise</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>do-time-consuming-job</span> []
</span></span><span style=display:flex><span>  (<span style=color:#000>Thread/sleep</span> <span style=color:#1c01ce>5000</span>)
</span></span><span style=display:flex><span>  (<span style=color:#000>deliver</span> <span style=color:#000>my-promise</span> <span style=color:#c41a16>&#34;delivered value&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>listen-and-callback</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>do-time-consuming-job</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;atom is like mutable var in other languages but atom is thread safe</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;ref dosync ref-set alter</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-ref</span> (<span style=color:#a90d91>ref </span><span style=color:#1c01ce>0</span>))
</span></span><span style=display:flex><span>(<span style=color:#000>dosync</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>alter </span><span style=color:#000>my-ref</span>
</span></span><span style=display:flex><span>         (<span style=color:#a90d91>fn </span>[<span style=color:#000>current_ref</span>]
</span></span><span style=display:flex><span>           (<span style=color:#a90d91>inc </span><span style=color:#000>current_ref</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>print </span><span style=color:#000>@</span><span style=color:#000>my-ref</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>user</span> (<span style=color:#a90d91>ref </span>{}))
</span></span><span style=display:flex><span>(<span style=color:#000>dosync</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>alter </span><span style=color:#000>user</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Kim&#34;</span>})
</span></span><span style=display:flex><span>  (<span style=color:#000>throw</span> (<span style=color:#000>Exception.</span> <span style=color:#c41a16>&#34;something wrong happens!&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>alter </span><span style=color:#000>user</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:age</span> <span style=color:#1c01ce>32</span>}))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>user-record</span> (<span style=color:#000>atom</span> {}))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>do </span>(<span style=color:#000>swap!</span> <span style=color:#000>user-record</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Kim&#34;</span>})
</span></span><span style=display:flex><span>    (<span style=color:#000>throw</span> (<span style=color:#000>Exception.</span> <span style=color:#c41a16>&#34;something wrong happens!&#34;</span>))
</span></span><span style=display:flex><span>    (<span style=color:#000>swap!</span> <span style=color:#000>user-record</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:age</span> <span style=color:#1c01ce>32</span>}))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>new </span><span style=color:#000>java.util.Date</span> <span style=color:#c41a16>&#34;2016/2/19&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>java.util.Date.</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>java.util.Date.</span> <span style=color:#c41a16>&#34;2016/2/19&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>Math/pow</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>)                                              <span style=color:#177500>;static method</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>rnd</span> (<span style=color:#a90d91>new </span><span style=color:#000>java.util.Random</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>. </span><span style=color:#000>rnd</span> <span style=color:#000>nextInt</span> <span style=color:#1c01ce>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>date1</span> (<span style=color:#a90d91>new </span><span style=color:#000>java.util.Date</span>)
</span></span><span style=display:flex><span>      <span style=color:#000>date2</span> (<span style=color:#a90d91>new </span><span style=color:#000>java.util.Date</span>)]
</span></span><span style=display:flex><span>  (<span style=color:#000>.equals</span> <span style=color:#000>date1</span> <span style=color:#000>date2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;(.instanceMember instance args*)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(.instanceMember Classname args*)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(.-instanceField instance)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(Classname/staticMethod args*)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Classname/staticField</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>geohash</span> [<span style=color:#000>lat</span> <span style=color:#000>lng</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;geohash:&#34;</span> <span style=color:#000>lat</span> <span style=color:#000>lng</span>)
</span></span><span style=display:flex><span>  <span style=color:#177500>;;this function take two separate values as params.</span>
</span></span><span style=display:flex><span>  <span style=color:#177500>;;and it return a geohash for that position</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#c41a16>:strs</span> [<span style=color:#000>lat</span> <span style=color:#000>lng</span>] <span style=color:#c41a16>:as</span> <span style=color:#000>coord</span>} {<span style=color:#c41a16>&#34;lat&#34;</span> <span style=color:#1c01ce>51.503331</span>, <span style=color:#c41a16>&#34;lng&#34;</span> <span style=color:#1c01ce>-0.119500</span>}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;calculating geohash for coordinates: &#34;</span> <span style=color:#000>coord</span>)
</span></span><span style=display:flex><span>  (<span style=color:#000>geohash</span> <span style=color:#000>lat</span> <span style=color:#000>lng</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;assoc-in associate使加入</span>
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><a href=https://zhimoe.github.io/tags/code rel=tag title=code>#code</a>
<a href=https://zhimoe.github.io/tags/clojure rel=tag title=clojure>#clojure</a></div><div id=buymeacoffee><img src=https://cdn.staticaly.com/gh/zhimoe/zhimoe.pic@main/20230708/buymeacoffee.67z8f89vpuo0.webp alt="Buy me a coffee"></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=https://zhimoe.github.io/post/spring-factorybean-contextaware/ rel=next title="Spring FactoryBean and ContextAware"><i class="fa fa-chevron-left"></i> Spring FactoryBean and ContextAware</a></div><div class="post-nav-prev post-nav-item"><a href=https://zhimoe.github.io/post/elasticsearch-query-dsl/ rel=prev title="理解Elasticsearch Query DSL中的JSON结构">理解Elasticsearch Query DSL中的JSON结构
<i class="fa fa-chevron-right"></i></a></div></div><div id=giscus class=giscus>评论加载中... 如果长时间无法加载，请针对 giscus.app 启用代理。</div><script src=https://giscus.app/client.js data-repo=zhimoe/zhimoe data-repo-id="MDEwOlJlcG9zaXRvcnkzMzQ2NjI4MDY=" data-category=General data-category-id=DIC_kwDOE_KMls4CXm1t data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=noborder_light data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target=post-toc-wrap>文章目录</li><li class=sidebar-nav-overview data-target=site-overview>站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=https://zhimoe.github.io/img/avatar.jpg alt=zhimoe><p class=site-author-name itemprop=name>zhimoe</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=https://zhimoe.github.io/post/><span class=site-state-item-count>71</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=https://zhimoe.github.io/categories/><span class=site-state-item-count>4</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=https://zhimoe.github.io/tags/><span class=site-state-item-count>44</span>
<span class=site-state-item-name>标签</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/zhimoe/ target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>
GitHub</a></span>
<span class=links-of-author-item><a href=https://www.zhihu.com/question/21142149/answer/52383396 target=_blank title=ZhiHu><i class="fa fa-fw fa-globe"></i>
ZhiHu</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class=links-of-blogroll-title><i class="fa fa-fw fa-external-link"></i>
书签</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://learngitbranching.js.org/ title=可视化Git target=_blank>可视化Git</a></li><li class=links-of-blogroll-item><a href=https://gallerix.asia/ title=绘画博物馆 target=_blank>绘画博物馆</a></li><li class=links-of-blogroll-item><a href=https://cheats.rs/ title=Rust小抄 target=_blank>Rust小抄</a></li><li class=links-of-blogroll-item><a href=https://developers.google.com/machine-learning/crash-course/ title=谷歌机器学习 target=_blank>谷歌机器学习</a></li></ul></div><div class="tagcloud-of-blogroll motion-element tagcloud-of-blogroll-inline"><div class=tagcloud-of-blogroll-title><i class="fa fa-fw fa-tags"></i>
标签云</div><ul class=tagcloud-of-blogroll-list><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/code>code</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/java>java</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/scala>scala</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/python>python</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/rust>rust</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/spring>spring</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/qq%E7%A9%BA%E9%97%B4>qq空间</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/%E5%B9%B6%E5%8F%91>并发</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/git>git</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/docker>docker</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/aop>aop</a></li><li class=tagcloud-of-blogroll-item><a href=https://zhimoe.github.io/tags/aurulent>aurulent</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class=post-toc><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#clojure-入门>clojure 入门</a></li></ul></nav></div></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>2016 - 2023</span>
<span class=copyright-icon><i class="fa fa-copyright"></i></span>
<span class=copyright-author>zhimoe</span></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i>
<span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=https://cdn.bootcdn.net/ajax/libs/jquery/2.1.4/jquery.min.js></script>
<script type=text/javascript src=https://zhimoe.github.io/js/search.js></script>
<script type=text/javascript src=https://zhimoe.github.io/js/affix.js></script>
<script type=text/javascript src=https://zhimoe.github.io/js/scrollspy.js></script>
<script type=text/javascript>function detectIE(){let e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),s=e.indexOf("Edge/");return t>0||n>0||s>0?-1:1}function getCntViewHeight(){let t=$("#content").height(),e=$(window).height();return t>e?t-e:$(document).height()-e}function getScrollbarWidth(){let e=$("<div />").addClass("scrollbar-measure").prependTo("body"),t=e[0],n=t.offsetWidth-t.clientWidth;return e.remove(),n}function registerBackTop(){let t=50,e=$(".back-to-top");$(window).on("scroll",function(){e.toggleClass("back-to-top-on",window.pageYOffset>t);let s=$(window).scrollTop(),o=getCntViewHeight(),i=s/o,n=Math.round(i*100),a=n>100?100:n;$("#scrollpercent>span").html(a)}),e.on("click",function(){$("html,body").animate({scrollTop:0,screenLeft:0},800)})}function initScrollSpy(){let e=".post-toc",s=$(e),t=".active-current";s.on("activate.bs.scrollspy",function(){let t=$(e+" .active").last();n(),t.addClass("active-current")}).on("clear.bs.scrollspy",n),$("body").scrollspy({target:e});function n(){$(e+" "+t).removeClass(t.substring(1))}}function initAffix(){let e=$(".header-inner").height(),t=parseInt($(".main").css("padding-bottom"),10),n=e+10;$(".sidebar-inner").affix({offset:{top:n,bottom:t}}),$(document).on("affixed.bs.affix",function(){updateTOCHeight(document.body.clientHeight-100)})}function initTOCDimension(){let e;$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){let e=document.body.clientHeight-100;updateTOCHeight(e)},0)}),updateTOCHeight(document.body.clientHeight-100);let t=getScrollbarWidth();$(".post-toc").css("width","calc(100% + "+t+"px)")}function updateTOCHeight(e){e=e||"auto",$(".post-toc").css("max-height",e)}$(function(){let t=$(".header-inner").height()+10;$("#sidebar").css({"margin-top":t}).show();let n=parseInt($("#sidebar").css("margin-top")),s=parseInt($(".sidebar-inner").css("height")),e=n+s,o=$(".content-wrap").height();o<e&&$(".content-wrap").css("min-height",e),$(".site-nav-toggle").on("click",function(){let e=$(".site-nav"),o=$(".toggle"),t="site-nav-on",i="toggle-close",n=e.hasClass(t),a=n?"slideUp":"slideDown",s=n?"removeClass":"addClass";e.stop()[a]("normal",function(){e[s](t),o[s](i)})}),registerBackTop(),initScrollSpy(),initAffix(),initTOCDimension(),$(".sidebar-nav-toc").click(function(){$(this).addClass("sidebar-nav-active"),$(this).next().removeClass("sidebar-nav-active"),$("."+$(this).next().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)}),$(".sidebar-nav-overview").click(function(){$(this).addClass("sidebar-nav-active"),$(this).prev().removeClass("sidebar-nav-active"),$("."+$(this).prev().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)})})</script><script src=https://cdn.bootcdn.net/ajax/libs/imageviewer/1.1.0/viewer.min.js></script>
<script type=text/javascript>$(function(){$(".post-body").viewer()})</script><script>const apiEndpoint="https://pageview.zhimoe.workers.dev/write",payload={url:document.location.href,title:document.title,referrer:window.frames.top.document.referrer};fetch(`${apiEndpoint}?${new URLSearchParams(payload)}`,{mode:"no-cors"}).catch(console.log)</script></body></html>