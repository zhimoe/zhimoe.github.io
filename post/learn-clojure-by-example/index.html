<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>通过例子学习 Clojure - zhimoe</title>
<meta property="og:title" content="通过例子学习 Clojure - zhimoe"><meta name=twitter:card content="summary"><meta property="description" content="这份笔记试图打造最强的 clojure 小抄，keep refactoring it&amp;hellip;"><meta property="og:description" content="这份笔记试图打造最强的 clojure 小抄，keep refactoring it&amp;hellip;"><link rel=stylesheet href=https://zhimoe.github.io/css/style.css><link rel=stylesheet href=https://zhimoe.github.io/css/fonts.css><link rel=stylesheet href=https://zhimoe.github.io/css/custom.css><link rel=stylesheet href=https://indestructibletype.com/fonts/Jost.css></head><body class="single post"><div class=crop-h></div><div class=crop-v></div><div class=crop-c></div><nav class="nav-top small"><div class=logo><a href=https://zhimoe.github.io/>新街记事</a></div><div class=menu><span class=active><a href=https://zhimoe.github.io/post/>博客</a></span>
<span><a href=https://zhimoe.github.io/categories/%E7%BC%96%E7%A8%8B/>编程</a></span>
<span><a href=https://zhimoe.github.io/categories/%E7%BF%BB%E8%AF%91/>翻译</a></span>
<span><a href=https://zhimoe.github.io/categories/%E9%9A%8F%E6%83%B3/>随想</a></span>
<span><a href=https://zhimoe.github.io/search/>搜索</a></span></div></nav><div class=article-meta><h1 class=title>通过例子学习 Clojure</h1><h3 class=meta-line><span><span class=date>2019-05-13</span>
</span><span class=term><a href=https://zhimoe.github.io/categories/%E7%BC%96%E7%A8%8B/ class=term-cat>编程</a>
<a href=https://zhimoe.github.io/tags/code/ class=term-tag>#code </a><a href=https://zhimoe.github.io/tags/clojure/ class=term-tag>#clojure</a></span></h3></div><div class=main><p>这份笔记试图打造最强的 clojure 小抄，keep refactoring it&mldr;</p><h2 id=clojure-入门>clojure 入门</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure><span style=display:flex><span>(<span style=color:#a90d91>ns </span><span style=color:#000>clj-notes.core</span>
</span></span><span style=display:flex><span>  (<span style=color:#c41a16>:gen-class</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;:gen-class generate java class file</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Parameter is variable in the declaration of function.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Argument is the actual value of this variable that gets passed to function.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;install leiningen:</span>
</span></span><span style=display:flex><span><span style=color:#177500>;put lein.bat in your PATH</span>
</span></span><span style=display:flex><span><span style=color:#177500>;open cmder,run: lein repl</span>
</span></span><span style=display:flex><span><span style=color:#177500>;start repl,use exit,(exit),(quit) or ctrl+d to quit repl</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;hello clojure&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Symbols are used to bind names to values</span>
</span></span><span style=display:flex><span><span style=color:#177500>;&#39; will prevent a form from being evaluated</span>
</span></span><span style=display:flex><span><span style=color:#177500>;&#39;() same as (quote ())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;def global variable</span>
</span></span><span style=display:flex><span><span style=color:#177500>;let local variable binding</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>object</span> <span style=color:#c41a16>&#34;light&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span><span style=color:#000>object</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>x</span> <span style=color:#1c01ce>10</span>
</span></span><span style=display:flex><span>      <span style=color:#000>y</span> <span style=color:#1c01ce>20</span>
</span></span><span style=display:flex><span>      <span style=color:#000>z</span> <span style=color:#1c01ce>30</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>+ </span><span style=color:#000>x</span> <span style=color:#000>y</span> <span style=color:#000>z</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;=&gt; 60</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;data collection</span>
</span></span><span style=display:flex><span><span style=color:#177500>;seq is abstract for list vector array</span>
</span></span><span style=display:flex><span><span style=color:#177500>;map</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>dict</span> {<span style=color:#c41a16>:k1</span> <span style=color:#c41a16>&#34;v1&#34;</span> <span style=color:#c41a16>:k2</span> <span style=color:#c41a16>&#34;v2&#34;</span>})
</span></span><span style=display:flex><span><span style=color:#177500>;keyword as function</span>
</span></span><span style=display:flex><span>(<span style=color:#c41a16>:k1</span> <span style=color:#000>dict</span>)                                                  <span style=color:#177500>;return v1</span>
</span></span><span style=display:flex><span><span style=color:#177500>;map as function</span>
</span></span><span style=display:flex><span>(<span style=color:#000>dict</span> <span style=color:#c41a16>:k1</span>)                                                  <span style=color:#177500>;return v1</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>v</span> (<span style=color:#000>dict</span> <span style=color:#c41a16>:k1</span>)]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>v</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;also you can use get on seq or map</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>get </span>{<span style=color:#c41a16>:a</span> <span style=color:#1c01ce>1</span> <span style=color:#c41a16>:b</span> <span style=color:#1c01ce>2</span>} <span style=color:#c41a16>:b</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;=&gt; 2</span>
</span></span><span style=display:flex><span><span style=color:#177500>;clojure.core/seq is a function that produces a sequence over the given argument. </span>
</span></span><span style=display:flex><span><span style=color:#177500>;Data types that clojure.core/seq can produce a sequence over are called seqable:</span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Clojure collections</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java maps</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All iterable types (types that implement java.util.Iterable)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java collections (java.util.Set, java.util.List, etc)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java arrays</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All types that implement java.lang.CharSequence interface, including Java strings</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All types that implement clojure.lang.Seqable interface</span>
</span></span><span style=display:flex><span><span style=color:#177500>;nil</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;function for seq or collection</span>
</span></span><span style=display:flex><span><span style=color:#177500>;=</span>
</span></span><span style=display:flex><span><span style=color:#177500>;count</span>
</span></span><span style=display:flex><span><span style=color:#177500>;conj</span>
</span></span><span style=display:flex><span><span style=color:#177500>;empty</span>
</span></span><span style=display:flex><span><span style=color:#177500>;seq</span>
</span></span><span style=display:flex><span><span style=color:#177500>;first</span>
</span></span><span style=display:flex><span><span style=color:#177500>;rest</span>
</span></span><span style=display:flex><span><span style=color:#177500>;next</span>
</span></span><span style=display:flex><span><span style=color:#177500>;count</span>
</span></span><span style=display:flex><span><span style=color:#177500>;counted?</span>
</span></span><span style=display:flex><span><span style=color:#177500>;conj</span>
</span></span><span style=display:flex><span><span style=color:#177500>;get</span>
</span></span><span style=display:flex><span><span style=color:#177500>;assoc</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;defn 定义函数</span>
</span></span><span style=display:flex><span><span style=color:#177500>;defn- 定义ns内私有函数</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>f</span>
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;the second line is doc-string&#34;</span>
</span></span><span style=display:flex><span>  {<span style=color:#c41a16>:added</span>  <span style=color:#c41a16>&#34;1.2&#34;</span>                                            <span style=color:#177500>;this is attr-map</span>
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:static</span> <span style=color:#000>true</span>}
</span></span><span style=display:flex><span>  [<span style=color:#000>param</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>print </span><span style=color:#c41a16>&#34;hello &#34;</span> <span style=color:#000>param</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>meta </span>(<span style=color:#a90d91>var </span><span style=color:#000>f</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;#&#39; is the reader macro for var and works the exactly same</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>meta </span><span style=color:#000>#</span><span style=color:#c41a16>&#39;f</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;fn create a function</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>f</span> (<span style=color:#a90d91>fn </span>[] (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;this is from fn function&#34;</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;#() is the shortcut for fn</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>plus-one</span> <span style=color:#000>#</span>(<span style=color:#a90d91>+ </span><span style=color:#1c01ce>1</span> <span style=color:#000>%</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;% will be replaced with arguments passed to the function</span>
</span></span><span style=display:flex><span><span style=color:#177500>;%1 is for the first argument, %2 is for the second and so on</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>des</span>
</span></span><span style=display:flex><span>  [{<span style=color:#000>k1</span> <span style=color:#c41a16>:k1</span>}]                                                <span style=color:#177500>;get :k1 value from argument (map) and binding it to k1(parameter)</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;destructing in map&#34;</span> <span style=color:#000>k1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>des</span> <span style=color:#000>dict</span>)                                                  <span style=color:#177500>;destructing in map v1</span>
</span></span><span style=display:flex><span><span style=color:#177500>;key don&#39;t have to be keyword</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-of</span>
</span></span><span style=display:flex><span>  [{<span style=color:#000>currency</span> <span style=color:#c41a16>&#34;currency&#34;</span>}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-of</span>
</span></span><span style=display:flex><span>  [{<span style=color:#000>currency</span> <span style=color:#c41a16>&#39;currency</span>}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;if want to destructing multi key,use :keys, in this case,parameter name(currency amount) </span>
</span></span><span style=display:flex><span><span style=color:#177500>;must same as arguments&#39;s keys(:currency :amount),can not use string as key</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-of</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:keys</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>]}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>* </span><span style=color:#000>currency</span> <span style=color:#000>amount</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>currency-of</span> {<span style=color:#c41a16>:currency</span> <span style=color:#c41a16>&#34;RMB&#34;</span> <span style=color:#c41a16>:amount</span> <span style=color:#1c01ce>100000</span>})              <span style=color:#177500>;ok</span>
</span></span><span style=display:flex><span>(<span style=color:#000>currency-of</span> {<span style=color:#c41a16>&#34;currency&#34;</span> <span style=color:#c41a16>&#34;RMB&#34;</span> <span style=color:#c41a16>&#34;amount&#34;</span> <span style=color:#1c01ce>100000</span>})            <span style=color:#177500>;currency will be nil,you will need use :strs or syms</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-strs</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:strs</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>]}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>currency-strs</span> {<span style=color:#c41a16>&#34;currency&#34;</span> <span style=color:#c41a16>&#34;RMB&#34;</span> <span style=color:#c41a16>&#34;amount&#34;</span> <span style=color:#1c01ce>100000</span>})          <span style=color:#177500>;ok</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-syms</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:syms</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>]}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>currency-syms</span> {<span style=color:#c41a16>&#39;currency</span> <span style=color:#c41a16>&#34;CNY&#34;</span> <span style=color:#c41a16>&#39;amount</span> <span style=color:#1c01ce>100000</span>})            <span style=color:#177500>;ok</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use :or to give a default value for parameter</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>currency-or</span>
</span></span><span style=display:flex><span>  [{<span style=color:#c41a16>:keys</span> [<span style=color:#000>currency</span> <span style=color:#000>amount</span>] <span style=color:#c41a16>:or</span> {<span style=color:#000>currency</span> <span style=color:#c41a16>&#34;USD&#34;</span>}}]
</span></span><span style=display:flex><span>  <span style=color:#000>currency</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>currency-or</span> {<span style=color:#c41a16>:amount</span> <span style=color:#1c01ce>100000</span>})                              <span style=color:#177500>;=&gt; &#34;USD&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use &amp; for Variadic Functions parameters</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>log</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>message</span> <span style=color:#000>&amp;</span> <span style=color:#000>args</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;args: &#34;</span> <span style=color:#000>args</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;named params , achieved by Variadic Functions destructing</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>job-info</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>&amp;</span> {<span style=color:#c41a16>:keys</span> [<span style=color:#a90d91>name </span><span style=color:#000>job</span> <span style=color:#000>income</span>] <span style=color:#c41a16>:or</span> {<span style=color:#000>job</span> <span style=color:#c41a16>&#34;unemployed&#34;</span> <span style=color:#000>income</span> <span style=color:#c41a16>&#34;$0.00&#34;</span>}}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>if </span><span style=color:#000>name</span>
</span></span><span style=display:flex><span>    [<span style=color:#a90d91>name </span><span style=color:#000>job</span> <span style=color:#000>income</span>]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;No name specified&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;cation! arguments to job-info is not a map</span>
</span></span><span style=display:flex><span>(<span style=color:#000>job-info</span> <span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Robert&#34;</span> <span style=color:#c41a16>:job</span> <span style=color:#c41a16>&#34;Engineer&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;[&#34;Robert&#34; &#34;Engineer&#34; &#34;$0.00&#34;]</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Without the use of a variadic argument list, </span>
</span></span><span style=display:flex><span><span style=color:#177500>;you would have to call the function with a single map argument such as</span>
</span></span><span style=display:flex><span>(<span style=color:#000>job-info</span> {<span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Robert&#34;</span> <span style=color:#c41a16>:job</span> <span style=color:#c41a16>&#34;Engineer&#34;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;destructuring example</span>
</span></span><span style=display:flex><span><span style=color:#177500>;https://gist.github.com/john2x/e1dca953548bfdfb9844</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-vec</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span> <span style=color:#000>d</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span> <span style=color:#000>d</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;1 2 3 nil</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>&amp;</span> <span style=color:#000>the-rest</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;a=&#34;</span> <span style=color:#000>a</span> <span style=color:#c41a16>&#34;b=&#34;</span> <span style=color:#000>b</span> <span style=color:#c41a16>&#34;the-rest=&#34;</span> <span style=color:#000>the-rest</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;a= 1 b= 2 the-rest= (3)</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#c41a16>:as</span> <span style=color:#000>all</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;[1 2 3]</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#c41a16>:as</span> <span style=color:#000>all</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;1 [1 2 3]</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[[<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>&amp;</span> <span style=color:#000>the-rest</span> <span style=color:#c41a16>:as</span> <span style=color:#000>all</span>] <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>the-rest</span> <span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;1 2 (3) [1 2 3]</span>
</span></span><span style=display:flex><span><span style=color:#177500>;note: &amp; the-rest convert vector to list,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;but :as preserves them (as a list, or as a vector)</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-vec</span> [<span style=color:#c41a16>&#34;first&#34;</span> <span style=color:#c41a16>&#34;second&#34;</span>])
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#1c01ce>0</span> <span style=color:#000>b</span> <span style=color:#1c01ce>1</span>} <span style=color:#000>my-vec</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span>))                                            <span style=color:#177500>;=&gt; &#34;first second&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;optional arguments to functions</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>foo</span> [<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>&amp;</span> <span style=color:#000>more-args</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>more-args</span>))
</span></span><span style=display:flex><span>(<span style=color:#000>foo</span> <span style=color:#c41a16>:a</span> <span style=color:#c41a16>:b</span>)                                                 <span style=color:#177500>;; =&gt; :a :b nil</span>
</span></span><span style=display:flex><span>(<span style=color:#000>foo</span> <span style=color:#c41a16>:a</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>:x</span>)                                              <span style=color:#177500>;; =&gt; :a :b (:x)</span>
</span></span><span style=display:flex><span>(<span style=color:#000>foo</span> <span style=color:#c41a16>:a</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>:x</span> <span style=color:#c41a16>:y</span> <span style=color:#c41a16>:z</span>)                                        <span style=color:#177500>;; =&gt; :a :b (:x :y :z)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;map destructuring</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-hashmap</span> {<span style=color:#c41a16>:a</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>&#34;B&#34;</span> <span style=color:#c41a16>:c</span> <span style=color:#c41a16>&#34;C&#34;</span> <span style=color:#c41a16>:d</span> <span style=color:#c41a16>&#34;D&#34;</span>})
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-nested-hashmap</span> {<span style=color:#c41a16>:a</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>:b</span> <span style=color:#c41a16>&#34;B&#34;</span> <span style=color:#c41a16>:c</span> <span style=color:#c41a16>&#34;C&#34;</span> <span style=color:#c41a16>:d</span> <span style=color:#c41a16>&#34;D&#34;</span> <span style=color:#c41a16>:q</span> {<span style=color:#c41a16>:x</span> <span style=color:#c41a16>&#34;X&#34;</span> <span style=color:#c41a16>:y</span> <span style=color:#c41a16>&#34;Y&#34;</span> <span style=color:#c41a16>:z</span> <span style=color:#c41a16>&#34;Z&#34;</span>}})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#c41a16>:a</span> <span style=color:#000>d</span> <span style=color:#c41a16>:d</span>} <span style=color:#000>my-hashmap</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>d</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;; =&gt; A D</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#c41a16>:a</span>, <span style=color:#000>b</span> <span style=color:#c41a16>:b</span>, {<span style=color:#000>x</span> <span style=color:#c41a16>:x</span>, <span style=color:#000>y</span> <span style=color:#c41a16>:y</span>} <span style=color:#c41a16>:q</span>} <span style=color:#000>my-nested-hashmap</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>x</span> <span style=color:#000>y</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;; =&gt; A B X Y</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#000>a</span> <span style=color:#c41a16>:a</span>, <span style=color:#000>b</span> <span style=color:#c41a16>:b</span>, <span style=color:#000>not-found</span> <span style=color:#c41a16>:not-found</span>, <span style=color:#c41a16>:or</span> {<span style=color:#000>not-found</span> <span style=color:#c41a16>&#34;:)&#34;</span>}, <span style=color:#c41a16>:as</span> <span style=color:#000>all</span>} <span style=color:#000>my-hashmap</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>not-found</span> <span style=color:#000>all</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;; =&gt; A B :) {:a A :b B :c C :d D}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;!!! There is no &amp; rest for maps.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;everything but false and nil evaluates to true in Clojure.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;:as bind entire map to param</span>
</span></span><span style=display:flex><span><span style=color:#177500>;See https://github.com/ring-clojure/ring/wiki/File-Uploads for explanation</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>file-handler</span>
</span></span><span style=display:flex><span>  <span style=color:#177500>;表示入参是一个map,里面有:params这个key,将:params</span>
</span></span><span style=display:flex><span>  <span style=color:#177500>;[{{{tempfile :tempfile filename :filename} &#34;file&#34;} :params :as request}]</span>
</span></span><span style=display:flex><span>  [{{{<span style=color:#000>tempfile</span> <span style=color:#c41a16>:tempfile</span> <span style=color:#000>filename</span> <span style=color:#c41a16>:filename</span>} <span style=color:#c41a16>&#34;file&#34;</span>} <span style=color:#c41a16>:params</span> <span style=color:#c41a16>:as</span> <span style=color:#000>request</span>}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>request</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>n</span> (<span style=color:#000>num-lines</span> <span style=color:#000>tempfile</span>)]
</span></span><span style=display:flex><span>    (<span style=color:#000>response</span> (<span style=color:#a90d91>str </span><span style=color:#c41a16>&#34;File &#34;</span> <span style=color:#000>filename</span> <span style=color:#c41a16>&#34; has &#34;</span> <span style=color:#000>n</span> <span style=color:#c41a16>&#34; lines &#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;a simple example</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>first-first</span>
</span></span><span style=display:flex><span>  [[[<span style=color:#000>i</span> <span style=color:#000>_</span>] <span style=color:#000>_</span>]]
</span></span><span style=display:flex><span>  <span style=color:#000>i</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>first-first</span> [[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span>] [<span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span>]])
</span></span><span style=display:flex><span><span style=color:#177500>;return 1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;(defn name doc-string? attr-map? [params*] prepost-map? body)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(defn name doc-string? attr-map? ([params*] prepost-map? body) + attr-map?)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;function can have params type hint</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>round</span>
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;^double here is type hint&#34;</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>^</span><span style=color:#a90d91>double </span><span style=color:#000>d</span> <span style=color:#000>^</span><span style=color:#a90d91>long </span><span style=color:#000>precision</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>factor</span> (<span style=color:#000>Math/pow</span> <span style=color:#1c01ce>10</span> <span style=color:#000>precision</span>)]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>/ </span>(<span style=color:#000>Math/floor</span> (<span style=color:#a90d91>* </span><span style=color:#000>d</span> <span style=color:#000>factor</span>)) <span style=color:#000>factor</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;不定长参数</span>
</span></span><span style=display:flex><span><span style=color:#177500>;重载函数</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>bar</span>
</span></span><span style=display:flex><span>  ([<span style=color:#000>a</span> <span style=color:#000>b</span>] (<span style=color:#000>bar</span> <span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#1c01ce>100</span>))
</span></span><span style=display:flex><span>  ([<span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span>] (<span style=color:#a90d91>* </span><span style=color:#000>a</span> <span style=color:#000>b</span> <span style=color:#000>c</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>bar</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>bar</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span> <span style=color:#1c01ce>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>keyworded-map</span> [<span style=color:#000>&amp;</span> {<span style=color:#c41a16>:keys</span> [<span style=color:#000>function</span> <span style=color:#000>sequence</span>]}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>map </span><span style=color:#000>function</span> <span style=color:#000>sequence</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>keyworded-map</span> <span style=color:#c41a16>:sequence</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>] <span style=color:#c41a16>:function</span> <span style=color:#000>#</span>(<span style=color:#a90d91>+ </span><span style=color:#000>%</span> <span style=color:#1c01ce>2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;trampoline</span>
</span></span><span style=display:flex><span><span style=color:#177500>;trampoline</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;namespace</span>
</span></span><span style=display:flex><span><span style=color:#177500>;create-ns create a namespace</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>create-ns </span><span style=color:#c41a16>&#39;zhi.moe.clj</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;in-ns move to a namespace</span>
</span></span><span style=display:flex><span><span style=color:#177500>;require loads a namespace and</span>
</span></span><span style=display:flex><span><span style=color:#177500>;refer refers the namespace.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;To do these at once, you can use use</span>
</span></span><span style=display:flex><span>(<span style=color:#000>require</span> <span style=color:#c41a16>&#39;clojure.by.example</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>clojure.by.example/favorite-language</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>use</span> <span style=color:#c41a16>&#39;clojure.by.example</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;you can rename namespace</span>
</span></span><span style=display:flex><span>(<span style=color:#000>require</span> <span style=color:#000>&#39;</span>[<span style=color:#000>clojure.by.example</span> <span style=color:#c41a16>:as</span> <span style=color:#000>temp-ns</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;ns macro creates a new namespace and gives you an opportunity to load other namespaces at the creation time</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;import java class</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>import </span><span style=color:#000>java.util.Date</span>)
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span>(<span style=color:#a90d91>str </span> (<span style=color:#a90d91>new </span><span style=color:#000>Date</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;Wed Jul 24 22:55:24 CST 2019</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;boolean</span>
</span></span><span style=display:flex><span><span style=color:#177500>;In Clojure, everything except false and nil are true.</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>if </span><span style=color:#1c01ce>1</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;it is true&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;will never print&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;if</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>if </span><span style=color:#000>true</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;executed when true&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;executed when false&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use do to execute multi expressions</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>if </span><span style=color:#000>true</span>
</span></span><span style=display:flex><span>  (<span style=color:#000>do</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;one&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;two&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;if-let:</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>positive-number</span> [<span style=color:#000>numbers</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>if-let </span>[<span style=color:#000>pos-nums</span> (<span style=color:#000>not-empty</span> (<span style=color:#a90d91>filter pos? </span><span style=color:#000>numbers</span>))]
</span></span><span style=display:flex><span>    <span style=color:#000>pos-nums</span>
</span></span><span style=display:flex><span>    <span style=color:#c41a16>&#34;no positive numbers&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;when when-let case cond condp</span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>cond-test</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>n</span>]
</span></span><span style=display:flex><span>  (<span style=color:#000>cond</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>= </span><span style=color:#000>n</span> <span style=color:#1c01ce>1</span>) <span style=color:#c41a16>&#34;n is 1&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>and </span>(<span style=color:#a90d91>&gt; </span><span style=color:#000>n</span> <span style=color:#1c01ce>3</span>) (<span style=color:#a90d91>&lt; </span><span style=color:#000>n</span> <span style=color:#1c01ce>10</span>)) <span style=color:#c41a16>&#34;n is over 3 and under 10&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c41a16>:else</span> <span style=color:#c41a16>&#34;n is other&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>cond-test</span> <span style=color:#1c01ce>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;string</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#a90d91>first </span><span style=color:#c41a16>&#34;Hirokuni&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a90d91>last </span><span style=color:#c41a16>&#34;Kim&#34;</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>str </span><span style=color:#c41a16>&#34;My name is &#34;</span> <span style=color:#a90d91>first </span><span style=color:#c41a16>&#34; &#34;</span> <span style=color:#000>last</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;format</span>
</span></span><span style=display:flex><span>(<span style=color:#000>format</span> <span style=color:#c41a16>&#34;My name is %s %s&#34;</span> <span style=color:#c41a16>&#34;Hirokuni&#34;</span> <span style=color:#c41a16>&#34;Kim&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;power function</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>power</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>x</span> <span style=color:#000>n</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>reduce * </span>(<span style=color:#a90d91>repeat </span><span style=color:#000>n</span> <span style=color:#000>x</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;bigint,N is a literal for bigint</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>+ </span><span style=color:#1c01ce>9223372036854775807</span> <span style=color:#1c01ce>10</span><span style=color:#000>N</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;list conj nth count</span>
</span></span><span style=display:flex><span><span style=color:#000>&#39;</span>(<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;vector conj nth count .indexOf</span>
</span></span><span style=display:flex><span>[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>]
</span></span><span style=display:flex><span>(<span style=color:#000>.indexOf</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>] <span style=color:#1c01ce>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>count </span>[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;set conj nth count disj sort contains? subset? superset?</span>
</span></span><span style=display:flex><span><span style=color:#000>#</span>{<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;map assoc merge keys vals</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>os</span> {<span style=color:#c41a16>:Apple</span> <span style=color:#c41a16>&#34;Mac&#34;</span> <span style=color:#c41a16>:Microsoft</span> <span style=color:#c41a16>&#34;Windows&#34;</span>}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>get </span><span style=color:#000>os</span> <span style=color:#c41a16>:Apple</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>assoc </span>{<span style=color:#c41a16>:Apple</span> <span style=color:#c41a16>&#34;Mac&#34;</span> <span style=color:#c41a16>:Microsoft</span> <span style=color:#c41a16>&#34;Windows&#34;</span>} <span style=color:#c41a16>:Commodore</span> <span style=color:#c41a16>&#34;Amiga&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Sequences are data types that abstract all more concrete data types with unified functions. </span>
</span></span><span style=display:flex><span><span style=color:#177500>;These functions are called the Seq library in Clojure.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;seq first rest cons concat map reduce into</span>
</span></span><span style=display:flex><span><span style=color:#177500>;To add an element to the head of sequence, use cons.</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>cons </span><span style=color:#1c01ce>4</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>(<span style=color:#a90d91>into </span>[] <span style=color:#000>`</span>(<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>reverse </span>[<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;get a sequence of infinite integers with iterate. Be careful, </span>
</span></span><span style=display:flex><span><span style=color:#177500>;though. Running this example will freeze your terminal since the evaluation of this expression never returns.</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>iterate</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>range</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>repeatedly</span> <span style=color:#1c01ce>5</span> (<span style=color:#a90d91>fn </span>[] (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;hi!&#34;</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;for each</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doseq </span>[<span style=color:#000>animal</span> [<span style=color:#c41a16>&#34;cat&#34;</span> <span style=color:#c41a16>&#34;dog&#34;</span> <span style=color:#c41a16>&#34;horse&#34;</span>]] (<span style=color:#a90d91>println </span><span style=color:#000>animal</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>take </span><span style=color:#1c01ce>5</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>0</span> <span style=color:#1c01ce>100</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>take-while neg? </span>[<span style=color:#1c01ce>-3</span> <span style=color:#1c01ce>-2</span> <span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>0</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;drop will remove the first n elements</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>drop </span><span style=color:#1c01ce>5</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>0</span> <span style=color:#1c01ce>10</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>drop-while neg? </span>[<span style=color:#1c01ce>-3</span> <span style=color:#1c01ce>-2</span> <span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>0</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;(0 1 2 3)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>remove pos? </span>[<span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>-2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span>])
</span></span><span style=display:flex><span><span style=color:#177500>;(-1 -2)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>filter pos? </span>[<span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>(<span style=color:#000>partition-by</span> <span style=color:#000>#</span>(<span style=color:#a90d91>&lt; </span><span style=color:#1c01ce>3</span> <span style=color:#000>%</span>) [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span>])
</span></span><span style=display:flex><span>(<span style=color:#000>group-by</span> <span style=color:#000>#</span>(<span style=color:#a90d91>&lt; </span><span style=color:#1c01ce>3</span> <span style=color:#000>%</span>) [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span> <span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>])
</span></span><span style=display:flex><span>(<span style=color:#a90d91>println </span>(<span style=color:#a90d91>take </span><span style=color:#1c01ce>5</span> (<span style=color:#a90d91>iterate inc </span><span style=color:#1c01ce>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;for compression</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> <span style=color:#000>&#39;</span>(<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>)]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>+ </span><span style=color:#1c01ce>10</span> <span style=color:#000>x</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>for</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;双重for 循环</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>10</span>)
</span></span><span style=display:flex><span>      <span style=color:#000>y</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>20</span>)
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:while</span> (<span style=color:#a90d91>&lt; </span><span style=color:#000>y</span> <span style=color:#000>x</span>)]
</span></span><span style=display:flex><span>  [<span style=color:#000>x</span> <span style=color:#000>y</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;&lt;==&gt; {x | x &gt;0}</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> <span style=color:#000>&#39;</span>(<span style=color:#1c01ce>-1</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span>)
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:when</span> (<span style=color:#a90d91>&gt; </span><span style=color:#000>x</span> <span style=color:#1c01ce>0</span>)]
</span></span><span style=display:flex><span>  <span style=color:#000>x</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>for </span>[<span style=color:#000>x</span> [<span style=color:#1c01ce>0</span> <span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span> <span style=color:#1c01ce>5</span>]
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:let</span> [<span style=color:#000>y</span> (<span style=color:#a90d91>* </span><span style=color:#000>x</span> <span style=color:#1c01ce>3</span>)]
</span></span><span style=display:flex><span>      <span style=color:#c41a16>:when</span> (<span style=color:#000>even?</span> <span style=color:#000>y</span>)]
</span></span><span style=display:flex><span>  <span style=color:#000>y</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;meta data for function parameters</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>round</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>^</span><span style=color:#a90d91>double </span><span style=color:#000>d</span> <span style=color:#000>^</span><span style=color:#a90d91>long </span><span style=color:#000>precision</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>factor</span> (<span style=color:#000>Math/pow</span> <span style=color:#1c01ce>10</span> <span style=color:#000>precision</span>)]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>/ </span>(<span style=color:#000>Math/floor</span> (<span style=color:#a90d91>* </span><span style=color:#000>d</span> <span style=color:#000>factor</span>)) <span style=color:#000>factor</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;# is Dispatch character that tells the Clojure reader how to interpret the next character using a read table</span>
</span></span><span style=display:flex><span><span style=color:#177500>;set</span>
</span></span><span style=display:flex><span><span style=color:#000>#</span>{<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>}
</span></span><span style=display:flex><span><span style=color:#177500>;discard</span>
</span></span><span style=display:flex><span>{<span style=color:#c41a16>:a</span> <span style=color:#1c01ce>1</span>, <span style=color:#000>#</span><span style=color:#000>_#_</span><span style=color:#c41a16>:b</span> <span style=color:#1c01ce>2</span>, <span style=color:#c41a16>:c</span> <span style=color:#1c01ce>3</span>}
</span></span><span style=display:flex><span><span style=color:#177500>;regular expression</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>re-matches </span><span style=color:#000>#</span><span style=color:#c41a16>&#34;^test$&#34;</span> <span style=color:#c41a16>&#34;test&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;anonymous function</span>
</span></span><span style=display:flex><span><span style=color:#000>#</span>(<span style=color:#a90d91>println </span><span style=color:#000>%</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;var quote</span>
</span></span><span style=display:flex><span>(<span style=color:#000>read-string</span> <span style=color:#c41a16>&#34;#&#39;foo&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;symbolic values</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>/ </span><span style=color:#1c01ce>1.0</span> <span style=color:#1c01ce>0.0</span>)                                                 <span style=color:#177500>;##Inf</span>
</span></span><span style=display:flex><span><span style=color:#177500>;tagged literals</span>
</span></span><span style=display:flex><span>(<span style=color:#000>type</span> <span style=color:#000>#</span><span style=color:#000>inst</span> <span style=color:#c41a16>&#34;2014-05-19T19:12:37.925-00:00&#34;</span>)                <span style=color:#177500>;java.util.Date</span>
</span></span><span style=display:flex><span><span style=color:#177500>;meta</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>meta </span><span style=color:#000>#</span><span style=color:#c41a16>&#39;fn-name</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;reader conditionals </span>
</span></span><span style=display:flex><span><span style=color:#000>#</span><span style=color:#000>?</span>(<span style=color:#c41a16>:clj</span>     (<span style=color:#000>Clojure</span> <span style=color:#000>expression</span>)
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:cljs</span>    (<span style=color:#000>ClojureScript</span> <span style=color:#000>expression</span>)
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:cljr</span>    (<span style=color:#000>Clojure</span> <span style=color:#000>CLR</span> <span style=color:#000>expression</span>)
</span></span><span style=display:flex><span>   <span style=color:#c41a16>:default</span> (<span style=color:#000>fallthrough</span> <span style=color:#000>expression</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;#?@ splicing reader conditional</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>build-list</span> []
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>list </span><span style=color:#000>#</span><span style=color:#000>?</span><span style=color:#000>@</span>(<span style=color:#c41a16>:clj</span>  [<span style=color:#1c01ce>5</span> <span style=color:#1c01ce>6</span> <span style=color:#1c01ce>7</span> <span style=color:#1c01ce>8</span>]
</span></span><span style=display:flex><span>            <span style=color:#c41a16>:cljs</span> [<span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span> <span style=color:#1c01ce>4</span>])))                              <span style=color:#177500>;return [5 6 7 8] when run on clojure</span>
</span></span><span style=display:flex><span><span style=color:#177500>;#= allows the reader to evaluate an arbitrary form during read time</span>
</span></span><span style=display:flex><span>(<span style=color:#000>read-string</span> <span style=color:#c41a16>&#34;#=(+ 3 4)&#34;</span>)                                   <span style=color:#177500>;7</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Recursion</span>
</span></span><span style=display:flex><span><span style=color:#177500>;simple recursion</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>fibo</span>
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;this is recursion function&#34;</span>
</span></span><span style=display:flex><span>  [<span style=color:#000>n</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>if </span>(<span style=color:#a90d91>or </span>(<span style=color:#a90d91>= </span><span style=color:#000>n</span> <span style=color:#1c01ce>0</span>) (<span style=color:#a90d91>= </span><span style=color:#000>n</span> <span style=color:#1c01ce>1</span>))
</span></span><span style=display:flex><span>    <span style=color:#000>n</span>
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>+ </span>(<span style=color:#000>fibo</span> (<span style=color:#a90d91>- </span><span style=color:#000>n</span> <span style=color:#1c01ce>1</span>)) (<span style=color:#000>fibo</span> (<span style=color:#a90d91>- </span><span style=color:#000>n</span> <span style=color:#1c01ce>2</span>)))))
</span></span><span style=display:flex><span><span style=color:#177500>;do not do this!!! take a long time to finish</span>
</span></span><span style=display:flex><span>(<span style=color:#000>fibo</span> <span style=color:#1c01ce>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;use recur</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>fibo-recur</span> [<span style=color:#000>iteration</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>let </span>[<span style=color:#000>fibo</span> (<span style=color:#a90d91>fn </span>[<span style=color:#000>one</span> <span style=color:#000>two</span> <span style=color:#000>n</span>]
</span></span><span style=display:flex><span>               (<span style=color:#a90d91>if </span>(<span style=color:#a90d91>= </span><span style=color:#000>iteration</span> <span style=color:#000>n</span>)
</span></span><span style=display:flex><span>                 <span style=color:#000>one</span>
</span></span><span style=display:flex><span>                 (<span style=color:#000>recur</span> <span style=color:#000>two</span> (<span style=color:#a90d91>+ </span><span style=color:#000>one</span> <span style=color:#000>two</span>) (<span style=color:#a90d91>inc </span><span style=color:#000>n</span>))))]
</span></span><span style=display:flex><span>    <span style=color:#177500>;recur re-binds it&#39;s arguments to new values and call the function with the new values</span>
</span></span><span style=display:flex><span>    <span style=color:#177500>;fibo is an inner function</span>
</span></span><span style=display:flex><span>    (<span style=color:#000>fibo</span> <span style=color:#1c01ce>0</span><span style=color:#000>N</span> <span style=color:#1c01ce>1</span><span style=color:#000>N</span> <span style=color:#1c01ce>0</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>fibo-recur</span> <span style=color:#1c01ce>1000</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;it is really fast</span>
</span></span><span style=display:flex><span><span style=color:#177500>;notes</span>
</span></span><span style=display:flex><span><span style=color:#177500>;with simple recursion, each recursive call creates a stack frame which is </span>
</span></span><span style=display:flex><span><span style=color:#177500>;a data to store the information of the called function on memory.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Doing deep recursion requires large memory for stack frames, but since it cannot, </span>
</span></span><span style=display:flex><span><span style=color:#177500>;we get StackOverflowError</span>
</span></span><span style=display:flex><span><span style=color:#177500>;尾递归</span>
</span></span><span style=display:flex><span><span style=color:#177500>;A function is tail recursive when the recursion is happening at the end of it&#39;s definition</span>
</span></span><span style=display:flex><span><span style=color:#177500>;In other words, a tail recursive function must return itself as it&#39;s returned value.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;When you use recur, it makes sure you are doing tail recursion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>loop</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;loop/recur is merely a friendly way to write recursion code.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;All imperative loops can be converted to recursions and all recursions can be converted to loops,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;so Clojure chose recursions.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Although you can write code that looks like an imperative loop with loop/recur,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Clojure is doing recursion under the hood.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defmacro </span><span style=color:#000>unless</span> [<span style=color:#a90d91>test </span><span style=color:#000>then</span>]
</span></span><span style=display:flex><span>  <span style=color:#c41a16>&#34;Evaluates then when test evaluates to be falsey&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>list </span><span style=color:#c41a16>&#39;if</span> (<span style=color:#a90d91>list </span><span style=color:#c41a16>&#39;not</span> <span style=color:#000>test</span>)
</span></span><span style=display:flex><span>        <span style=color:#000>then</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>macroexpand </span><span style=color:#000>&#39;</span>(<span style=color:#000>unless</span> <span style=color:#000>false</span> (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;hi&#34;</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;&#39; quoting</span>
</span></span><span style=display:flex><span><span style=color:#177500>;` syntax-quoting returns the fully qualified namespace.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Using fully qualified namespace is very important in order to avoid name conflicts when defining macro.</span>
</span></span><span style=display:flex><span><span style=color:#177500>;~ unquote</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>`</span>(<span style=color:#a90d91>+ </span><span style=color:#000>~</span>(<span style=color:#a90d91>list </span><span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;(clojure.core/+ (1 2 3))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>`</span>(<span style=color:#a90d91>+ </span><span style=color:#000>~@</span>(<span style=color:#a90d91>list </span><span style=color:#1c01ce>1</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;(clojure.core/+ 1 2 3)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;The ~@ unquote splice works just like ~ unquote,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;except it expands a sequence and splice the contents of </span>
</span></span><span style=display:flex><span><span style=color:#177500>;the sequence into the enclosing syntax-quoted data structure</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;thread first macro</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>-&gt; </span>[]
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>conj </span><span style=color:#1c01ce>1</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>conj </span><span style=color:#1c01ce>2</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a90d91>conj </span><span style=color:#1c01ce>3</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;[1 2 3]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>first </span>(<span style=color:#000>.split</span> (<span style=color:#000>.replace</span> (<span style=color:#000>.toUpperCase</span> <span style=color:#c41a16>&#34;a b c d&#34;</span>) <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>&#34;X&#34;</span>) <span style=color:#c41a16>&#34; &#34;</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;&#34;X&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;;Perhaps easier to read:</span>
</span></span><span style=display:flex><span><span style=color:#177500>;-&gt; 后面是初始参数,第2行开始每一行是一个函数调用,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;且上一行的返回值会作为这一行第一个参数(这就是thread first)的first含义</span>
</span></span><span style=display:flex><span><span style=color:#177500>;这里的thread是管道的意思,而不是并发编程的线程</span>
</span></span><span style=display:flex><span><span style=color:#177500>;如果省略(),那么野生符号(bare symbol)和keyword都会当作一个函数调用,</span>
</span></span><span style=display:flex><span><span style=color:#177500>;例如,这里的.toUpperCase是bare symbol,等效于(.toUpperCase ,,,)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;clojure中 逗号等于空白符,所以上面用,,,表示将会插入的参数(即&#34;a b c d&#34;)</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>-&gt; </span><span style=color:#c41a16>&#34;a b c d&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>.toUpperCase</span>
</span></span><span style=display:flex><span>    (<span style=color:#000>.replace</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>&#34;X&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#000>.split</span> <span style=color:#c41a16>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#000>first</span>)
</span></span><span style=display:flex><span><span style=color:#177500>;same as follow, ,,, is equals whitespace</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>-&gt; </span><span style=color:#c41a16>&#34;a b c d&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#000>.toUpperCase</span>,,,)
</span></span><span style=display:flex><span>    (<span style=color:#000>.replace</span> <span style=color:#c41a16>&#34;A&#34;</span> <span style=color:#c41a16>&#34;X&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#000>.split</span> <span style=color:#c41a16>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#000>first</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;suppose a function</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>calculate</span> []
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>reduce + </span>(<span style=color:#a90d91>map </span><span style=color:#000>#</span>(<span style=color:#a90d91>* </span><span style=color:#000>%</span> <span style=color:#000>%</span>) (<span style=color:#a90d91>filter </span><span style=color:#000>odd?</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>10</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;same as</span>
</span></span><span style=display:flex><span><span style=color:#177500>;上一行的结果作为最后一个参数插入,这叫thread last</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>calculate*</span> []
</span></span><span style=display:flex><span>  (<span style=color:#000>-&gt;&gt;</span> (<span style=color:#a90d91>range </span><span style=color:#1c01ce>10</span>)
</span></span><span style=display:flex><span>       (<span style=color:#a90d91>filter </span><span style=color:#000>odd?</span>,,,)
</span></span><span style=display:flex><span>       (<span style=color:#a90d91>map </span><span style=color:#000>#</span>(<span style=color:#a90d91>* </span><span style=color:#000>%</span> <span style=color:#000>%</span>),,,)
</span></span><span style=display:flex><span>       (<span style=color:#a90d91>reduce </span><span style=color:#000>+</span>,,,)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;如果想要指定每次插入的位置那么需要用 as-&gt;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;v是每一行的返回值的名称,这样你可以在下一行任意参数位置指定</span>
</span></span><span style=display:flex><span>(<span style=color:#000>as-&gt;</span> [<span style=color:#c41a16>:foo</span> <span style=color:#c41a16>:bar</span>] <span style=color:#000>v</span>
</span></span><span style=display:flex><span>      (<span style=color:#a90d91>map name </span><span style=color:#000>v</span>)
</span></span><span style=display:flex><span>      (<span style=color:#a90d91>first </span><span style=color:#000>v</span>)
</span></span><span style=display:flex><span>      (<span style=color:#000>.substring</span> <span style=color:#000>v</span> <span style=color:#1c01ce>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;</span>
</span></span><span style=display:flex><span><span style=color:#177500>;destructing</span>
</span></span><span style=display:flex><span>({<span style=color:#c41a16>:keys</span> [<span style=color:#000>firstname</span> <span style=color:#000>lastname</span>] <span style=color:#c41a16>:as</span> <span style=color:#000>person</span>} {<span style=color:#c41a16>:firstname</span> <span style=color:#c41a16>&#34;John&#34;</span> <span style=color:#c41a16>:lastname</span> <span style=color:#c41a16>&#34;Smith&#34;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;future and deref</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>future-val</span> (<span style=color:#000>future</span> (<span style=color:#a90d91>inc </span><span style=color:#1c01ce>1</span>))]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span>(<span style=color:#a90d91>deref </span><span style=color:#000>future-val</span>)))
</span></span><span style=display:flex><span><span style=color:#177500>;deref == @</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>future-val</span> (<span style=color:#000>future</span> (<span style=color:#a90d91>inc </span><span style=color:#1c01ce>1</span>))]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#000>@</span><span style=color:#000>future-val</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-future</span> (<span style=color:#000>future</span> (<span style=color:#000>Thread/sleep</span> <span style=color:#1c01ce>5000</span>)))
</span></span><span style=display:flex><span>(<span style=color:#000>repeatedly</span> <span style=color:#1c01ce>6</span>
</span></span><span style=display:flex><span>            (<span style=color:#a90d91>fn </span>[]
</span></span><span style=display:flex><span>              (<span style=color:#a90d91>println </span>(<span style=color:#000>realized?</span> <span style=color:#000>my-future</span>))
</span></span><span style=display:flex><span>              (<span style=color:#000>Thread/sleep</span> <span style=color:#1c01ce>1000</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>doc </span><span style=color:#000>future</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;promise</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-promise</span> (<span style=color:#000>promise</span>))
</span></span><span style=display:flex><span><span style=color:#177500>;you define a promise</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>listen-and-callback</span> (<span style=color:#a90d91>fn </span>[]
</span></span><span style=display:flex><span>                           (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;Start listening...&#34;</span>)
</span></span><span style=display:flex><span>                           (<span style=color:#000>future</span> (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;Callback fired: &#34;</span> <span style=color:#000>@</span><span style=color:#000>my-promise</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>do-time-consuming-job</span> []
</span></span><span style=display:flex><span>  (<span style=color:#000>Thread/sleep</span> <span style=color:#1c01ce>5000</span>)
</span></span><span style=display:flex><span>  (<span style=color:#000>deliver</span> <span style=color:#000>my-promise</span> <span style=color:#c41a16>&#34;delivered value&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#000>listen-and-callback</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>do-time-consuming-job</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;atom is like mutable var in other languages but atom is thread safe</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;ref dosync ref-set alter</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>my-ref</span> (<span style=color:#a90d91>ref </span><span style=color:#1c01ce>0</span>))
</span></span><span style=display:flex><span>(<span style=color:#000>dosync</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>alter </span><span style=color:#000>my-ref</span>
</span></span><span style=display:flex><span>         (<span style=color:#a90d91>fn </span>[<span style=color:#000>current_ref</span>]
</span></span><span style=display:flex><span>           (<span style=color:#a90d91>inc </span><span style=color:#000>current_ref</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>print </span><span style=color:#000>@</span><span style=color:#000>my-ref</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>user</span> (<span style=color:#a90d91>ref </span>{}))
</span></span><span style=display:flex><span>(<span style=color:#000>dosync</span>
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>alter </span><span style=color:#000>user</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Kim&#34;</span>})
</span></span><span style=display:flex><span>  (<span style=color:#000>throw</span> (<span style=color:#000>Exception.</span> <span style=color:#c41a16>&#34;something wrong happens!&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>alter </span><span style=color:#000>user</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:age</span> <span style=color:#1c01ce>32</span>}))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>user-record</span> (<span style=color:#000>atom</span> {}))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>do </span>(<span style=color:#000>swap!</span> <span style=color:#000>user-record</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:name</span> <span style=color:#c41a16>&#34;Kim&#34;</span>})
</span></span><span style=display:flex><span>    (<span style=color:#000>throw</span> (<span style=color:#000>Exception.</span> <span style=color:#c41a16>&#34;something wrong happens!&#34;</span>))
</span></span><span style=display:flex><span>    (<span style=color:#000>swap!</span> <span style=color:#000>user-record</span> <span style=color:#a90d91>merge </span>{<span style=color:#c41a16>:age</span> <span style=color:#1c01ce>32</span>}))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;Java</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>new </span><span style=color:#000>java.util.Date</span> <span style=color:#c41a16>&#34;2016/2/19&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>java.util.Date.</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>java.util.Date.</span> <span style=color:#c41a16>&#34;2016/2/19&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#000>Math/pow</span> <span style=color:#1c01ce>2</span> <span style=color:#1c01ce>3</span>)                                              <span style=color:#177500>;static method</span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>def </span><span style=color:#000>rnd</span> (<span style=color:#a90d91>new </span><span style=color:#000>java.util.Random</span>))
</span></span><span style=display:flex><span>(<span style=color:#a90d91>. </span><span style=color:#000>rnd</span> <span style=color:#000>nextInt</span> <span style=color:#1c01ce>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[<span style=color:#000>date1</span> (<span style=color:#a90d91>new </span><span style=color:#000>java.util.Date</span>)
</span></span><span style=display:flex><span>      <span style=color:#000>date2</span> (<span style=color:#a90d91>new </span><span style=color:#000>java.util.Date</span>)]
</span></span><span style=display:flex><span>  (<span style=color:#000>.equals</span> <span style=color:#000>date1</span> <span style=color:#000>date2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;(.instanceMember instance args*)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(.instanceMember Classname args*)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(.-instanceField instance)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;(Classname/staticMethod args*)</span>
</span></span><span style=display:flex><span><span style=color:#177500>;Classname/staticField</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>defn </span><span style=color:#000>geohash</span> [<span style=color:#000>lat</span> <span style=color:#000>lng</span>]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;geohash:&#34;</span> <span style=color:#000>lat</span> <span style=color:#000>lng</span>)
</span></span><span style=display:flex><span>  <span style=color:#177500>;;this function take two separate values as params.</span>
</span></span><span style=display:flex><span>  <span style=color:#177500>;;and it return a geohash for that position</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#a90d91>let </span>[{<span style=color:#c41a16>:strs</span> [<span style=color:#000>lat</span> <span style=color:#000>lng</span>] <span style=color:#c41a16>:as</span> <span style=color:#000>coord</span>} {<span style=color:#c41a16>&#34;lat&#34;</span> <span style=color:#1c01ce>51.503331</span>, <span style=color:#c41a16>&#34;lng&#34;</span> <span style=color:#1c01ce>-0.119500</span>}]
</span></span><span style=display:flex><span>  (<span style=color:#a90d91>println </span><span style=color:#c41a16>&#34;calculating geohash for coordinates: &#34;</span> <span style=color:#000>coord</span>)
</span></span><span style=display:flex><span>  (<span style=color:#000>geohash</span> <span style=color:#000>lat</span> <span style=color:#000>lng</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>;assoc-in associate使加入</span>
</span></span></code></pre></div><nav class="post-nav fullwidth"><span>&larr; <a href=https://zhimoe.github.io/post/spring-factorybean-contextaware/>Spring FactoryBean and ContextAware</a></span>
<span><a href=https://zhimoe.github.io/post/elasticsearch-query-dsl/>理解 Elasticsearch Query DSL 中的 JSON 结构</a> &rarr;</span></nav></div><footer class=small><link rel=stylesheet href=//cdn.jsdelivr.net/gh/rstudio/markdown/inst/resources/prism-xcode.css><script src=//cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js defer></script><script src=//cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/copy-button.min.js defer></script><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@xiee/utils/css/copy-button.min.css><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/heading-anchor.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/fullwidth.min.js defer></script><hr><p class=nav-bottom><span><a href=https://zhi.moe>ZhiMoe</a> © 2024</span>
<span class=menu-bottom><a href=https://zhimoe.github.io/categories/>Categories</a> <a href=https://zhimoe.github.io/tags/>Tags</a>
<a href=https://zhimoe.github.io/post/index.xml type=application/rss+xml title="RSS feed">Subscribe</a>
<a href=#>Back to Top</a></span></p></footer></body></html>