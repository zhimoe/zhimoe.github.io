<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Scala Collection Tips - 香取海</title>
<meta property="og:title" content="Scala Collection Tips - 香取海"><meta name=twitter:card content="summary"><meta property="description" content="scala collection 提供了一整套独立于 Java 的高性能集合，使用上非常灵活，所以需要清楚一些常用的方法：
[&amp;hellip;] //reduce 是一个二元函数，遍历整个集合 List(1, 3, 5).reduceLeft(_ + _) // == ((1+3)+5) //reduceRight start from end of the collection //also &amp;hellip;"><meta property="og:description" content="scala collection 提供了一整套独立于 Java 的高性能集合，使用上非常灵活，所以需要清楚一些常用的方法：
[&amp;hellip;] //reduce 是一个二元函数，遍历整个集合 List(1, 3, 5).reduceLeft(_ + _) // == ((1+3)+5) //reduceRight start from end of the collection //also &amp;hellip;"><link rel=stylesheet href=../../css/style.css><link rel=stylesheet href=../../css/fonts.css><link rel=stylesheet href=../../css/custom.css><link rel=icon type=image/png href=../../img/logo.png><link rel=apple-touch-icon href=../../img/logo.png><link rel=apple-touch-icon-precomposed href=../../img/logo.png></head><body class="single post"><div class=crop-h></div><div class=crop-v></div><div class=crop-c></div><nav class="nav-top small"><div class=logo><a href=../../>香取海</a></div><div class=menu><span class=active><a href=../../post/>博客</a></span>
<span><a href=../../categories/%E7%BC%96%E7%A8%8B/>编程</a></span>
<span><a href=../../categories/%E7%BF%BB%E8%AF%91/>翻译</a></span>
<span><a href=../../categories/%E9%9A%8F%E6%83%B3/>随想</a></span>
<span><a href=../../search/>搜索</a></span></div></nav><div class=article-meta><h1 class=title>Scala Collection Tips</h1><h3 class=meta-line><span><span class=date>2019-05-19</span>
</span><span class=term><a href=../../categories/%E7%BC%96%E7%A8%8B/ class=term-cat>编程</a>
<a href=../../tags/code/ class=term-tag>#code </a><a href=../../tags/scala/ class=term-tag>#scala</a></span></h3></div><div class=main><nav id=TableOfContents><ul><li><a href=#reduce-fold-scan>reduce fold scan</a></li><li><a href=#集合的符号方法>集合的符号方法</a></li><li><a href=#其他>其他</a></li><li><a href=#scala-213-collection>scala 2.13 collection</a></li></ul></nav><p>scala collection 提供了一整套独立于 Java 的高性能集合，使用上非常灵活，所以需要清楚一些常用的方法：</p><ul><li><input checked disabled type=checkbox> reduce fold scan</li><li><input checked disabled type=checkbox> 集合的符号方法</li><li><input checked disabled type=checkbox> 数组，tuple</li><li><input checked disabled type=checkbox> 2.13 的集合架构</li></ul><h2 id=reduce-fold-scan>reduce fold scan</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#177500>//reduce 是一个二元函数，遍历整个集合
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#3f6e75>List</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>5</span><span style=color:#000>).</span><span style=color:#000>reduceLeft</span><span style=color:#000>(</span><span style=color:#a90d91>_</span> <span style=color:#000>+</span> <span style=color:#a90d91>_</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>// == ((1+3)+5)
</span></span></span><span style=display:flex><span><span style=color:#177500>//reduceRight start from end of the collection
</span></span></span><span style=display:flex><span><span style=color:#177500>//also you can given initial argument
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#3f6e75>List</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>5</span><span style=color:#000>).</span><span style=color:#000>foldLeft</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;&#34;</span><span style=color:#000>)(</span><span style=color:#a90d91>_</span> <span style=color:#000>+</span> <span style=color:#a90d91>_</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>// == 135
</span></span></span><span style=display:flex><span><span style=color:#177500>//foldLeft 等价于 \: 操作符
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>(</span><span style=color:#1c01ce>0</span> <span style=color:#000>/:</span> <span style=color:#3f6e75>List</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>5</span><span style=color:#000>))</span> <span style=color:#000>(</span><span style=color:#a90d91>_</span> <span style=color:#000>-</span> <span style=color:#a90d91>_</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//folding 常用于替代 for-loop
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>wf1</span> <span style=color:#a90d91>=</span> <span style=color:#000>scala</span><span style=color:#000>.</span><span style=color:#000>collection</span><span style=color:#000>.</span><span style=color:#000>mutable</span><span style=color:#000>.</span><span style=color:#3f6e75>Map</span><span style=color:#000>[</span><span style=color:#a90d91>Char</span>, <span style=color:#a90d91>Int</span><span style=color:#000>]()</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#000>c</span> <span style=color:#a90d91>&lt;-</span> <span style=color:#c41a16>&#34;Mississippi&#34;</span><span style=color:#000>)</span> <span style=color:#000>wf1</span><span style=color:#000>(</span><span style=color:#000>c</span><span style=color:#000>)</span> <span style=color:#a90d91>=</span> <span style=color:#000>wf1</span><span style=color:#000>.</span><span style=color:#000>getOrElse</span><span style=color:#000>(</span><span style=color:#000>c</span><span style=color:#000>,</span> <span style=color:#1c01ce>0</span><span style=color:#000>)</span> <span style=color:#000>+</span> <span style=color:#1c01ce>1</span>
</span></span><span style=display:flex><span><span style=color:#177500>// Now freq is Map(&#39;i&#39; -&gt; 4, &#39;M&#39; -&gt; 1, &#39;s&#39; -&gt; 4, &#39;p&#39; -&gt; 2)
</span></span></span><span style=display:flex><span><span style=color:#177500></span>
</span></span><span style=display:flex><span><span style=color:#177500>//注意使用了不可变 map
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>wf</span> <span style=color:#a90d91>=</span> <span style=color:#000>(</span><span style=color:#3f6e75>Map</span><span style=color:#000>[</span><span style=color:#a90d91>Char</span>, <span style=color:#a90d91>Int</span><span style=color:#000>]()</span> <span style=color:#000>/:</span> <span style=color:#c41a16>&#34;Mississippi&#34;</span><span style=color:#000>)</span> <span style=color:#000>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>(</span><span style=color:#000>m</span><span style=color:#000>,</span> <span style=color:#000>c</span><span style=color:#000>)</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>m</span> <span style=color:#000>+</span> <span style=color:#000>(</span><span style=color:#000>c</span> <span style=color:#000>-&gt;</span> <span style=color:#000>(</span><span style=color:#000>m</span><span style=color:#000>.</span><span style=color:#000>getOrElse</span><span style=color:#000>(</span><span style=color:#000>c</span><span style=color:#000>,</span> <span style=color:#1c01ce>0</span><span style=color:#000>)</span> <span style=color:#000>+</span> <span style=color:#1c01ce>1</span><span style=color:#000>))</span>
</span></span><span style=display:flex><span><span style=color:#000>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//scan 方法可以获得每一步中间结果集
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>(</span><span style=color:#1c01ce>1</span> <span style=color:#000>to</span> <span style=color:#1c01ce>10</span><span style=color:#000>).</span><span style=color:#000>scanLeft</span><span style=color:#000>(</span><span style=color:#1c01ce>0</span><span style=color:#000>)(</span><span style=color:#a90d91>_</span> <span style=color:#000>+</span> <span style=color:#a90d91>_</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//Vector(0, 1, 3, 6, 10, 15, 21, 28, 36, 45, 55)
</span></span></span></code></pre></div><h2 id=集合的符号方法>集合的符号方法</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#177500>//+ 表示添加一个元素到无序集合
</span></span></span><span style=display:flex><span><span style=color:#177500>// :+ +:表示添加到有序集合的首/尾
</span></span></span><span style=display:flex><span><span style=color:#177500>//elem append or prepend to coll (Seq)
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>coll</span> <span style=color:#a90d91>:</span><span style=color:#a90d91>+</span> <span style=color:#a90d91>elem</span>
</span></span><span style=display:flex><span><span style=color:#000>elem</span> <span style=color:#000>+:</span> <span style=color:#000>coll</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//add elem to set/map
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>coll</span> <span style=color:#000>+</span> <span style=color:#000>elem</span>
</span></span><span style=display:flex><span><span style=color:#000>coll</span> <span style=color:#000>+</span> <span style=color:#000>(</span><span style=color:#000>e1</span><span style=color:#000>,</span><span style=color:#000>e2</span><span style=color:#000>,...)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>coll</span> <span style=color:#000>++</span> <span style=color:#000>coll2</span>
</span></span><span style=display:flex><span><span style=color:#000>coll2</span> <span style=color:#000>++:</span> <span style=color:#000>coll</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>// prepend to lst
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>elem</span> <span style=color:#a90d91>:</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>lst</span> 
</span></span><span style=display:flex><span><span style=color:#000>lst2</span> <span style=color:#a90d91>:</span><span style=color:#a90d91>::</span> <span style=color:#a90d91>lst</span>
</span></span><span style=display:flex><span><span style=color:#177500>// 等价 list ++: list2
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>list</span> <span style=color:#a90d91>:</span><span style=color:#a90d91>::</span> <span style=color:#a90d91>list2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>// 含有=的表示修改，必须是 mutable 的集合
</span></span></span><span style=display:flex><span><span style=color:#177500></span>
</span></span><span style=display:flex><span><span style=color:#177500>// TIP: As you can see, Scala provides many operators for adding and removing
</span></span></span><span style=display:flex><span><span style=color:#177500>// elements. Here is a summary:
</span></span></span><span style=display:flex><span><span style=color:#177500>// 1. Append (:+) or prepend (+:) to a sequence.
</span></span></span><span style=display:flex><span><span style=color:#177500>// 2. Add (+) to an unordered collection.
</span></span></span><span style=display:flex><span><span style=color:#177500>// 3. Remove with the - operator.
</span></span></span><span style=display:flex><span><span style=color:#177500>// 4. Use ++ and -- for bulk add and remove.
</span></span></span><span style=display:flex><span><span style=color:#177500>// 5. Mutations are += ++= -= --=.
</span></span></span><span style=display:flex><span><span style=color:#177500>// 6. For lists, many Scala programmers prefer the :: and ::: operators.
</span></span></span><span style=display:flex><span><span style=color:#177500>// 7. Stay away from ++: +=: ++=:.
</span></span></span></code></pre></div><p>NOTE: For lists, you can use +: instead of :: for consistency, with one<br>exception: Pattern matching (case h::t) does not work with the +: operator.</p><h2 id=其他>其他</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#177500>//数组的笔记
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>ints</span> <span style=color:#a90d91>=</span> <span style=color:#a90d91>new</span> <span style=color:#3f6e75>Array</span><span style=color:#000>[</span><span style=color:#a90d91>Int</span><span style=color:#000>](</span><span style=color:#1c01ce>30</span><span style=color:#000>)</span> <span style=color:#177500>// empty array
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>ints2</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>Array</span><span style=color:#000>[</span><span style=color:#a90d91>Int</span><span style=color:#000>](</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>,</span> <span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>4</span><span style=color:#000>)</span> <span style=color:#177500>// array with init values
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>matrix4x9</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>Array</span><span style=color:#000>.</span><span style=color:#000>ofDim</span><span style=color:#000>[</span><span style=color:#a90d91>Double</span><span style=color:#000>](</span><span style=color:#1c01ce>4</span><span style=color:#000>,</span> <span style=color:#1c01ce>9</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//update
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>ints2</span><span style=color:#000>(</span><span style=color:#1c01ce>3</span><span style=color:#000>)</span> <span style=color:#a90d91>=</span> <span style=color:#1c01ce>1000</span>
</span></span><span style=display:flex><span><span style=color:#177500>// or
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>ints2</span><span style=color:#000>.</span><span style=color:#000>update</span><span style=color:#000>(</span><span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>1000</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//求和
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>ints2Sum</span> <span style=color:#a90d91>=</span> <span style=color:#000>ints2</span><span style=color:#000>.</span><span style=color:#000>sum</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>val</span> <span style=color:#000>days</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>Array</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Monday&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;Tuesday&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;Wednesday&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;Thrusday&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;Friday&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;Saturday&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;Sunday&#34;</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//遍历
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#000>i</span> <span style=color:#a90d91>&lt;-</span> <span style=color:#1c01ce>0</span> <span style=color:#000>until</span> <span style=color:#000>days</span><span style=color:#000>.</span><span style=color:#000>length</span><span style=color:#000>)</span> <span style=color:#000>println</span><span style=color:#000>(</span><span style=color:#000>days</span><span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>))</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#000>day</span> <span style=color:#a90d91>&lt;-</span> <span style=color:#000>days</span><span style=color:#000>)</span> <span style=color:#000>println</span><span style=color:#000>(</span><span style=color:#000>day</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#000>days</span> <span style=color:#000>foreach</span> <span style=color:#000>println</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//遍历中使用 index
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>days</span><span style=color:#000>.</span><span style=color:#000>zipWithIndex</span><span style=color:#000>.</span><span style=color:#000>map</span> <span style=color:#000>{</span> <span style=color:#a90d91>case</span> <span style=color:#000>(</span><span style=color:#000>e</span><span style=color:#000>,</span> <span style=color:#000>i</span><span style=color:#000>)</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>,</span> <span style=color:#000>e</span><span style=color:#000>)</span> <span style=color:#000>}</span>
</span></span><span style=display:flex><span><span style=color:#177500>//faster
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>for</span> <span style=color:#000>(</span><span style=color:#000>i</span> <span style=color:#a90d91>&lt;-</span> <span style=color:#000>days</span><span style=color:#000>.</span><span style=color:#000>indices</span><span style=color:#000>)</span> <span style=color:#a90d91>yield</span> <span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>,</span> <span style=color:#000>days</span><span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>))</span>
</span></span><span style=display:flex><span><span style=color:#177500>//Possibly fastest
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#3f6e75>Array</span><span style=color:#000>.</span><span style=color:#000>tabulate</span><span style=color:#000>(</span><span style=color:#000>days</span><span style=color:#000>.</span><span style=color:#000>length</span><span style=color:#000>)</span> <span style=color:#000>{</span> <span style=color:#000>i</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>,</span> <span style=color:#000>days</span><span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>))</span> <span style=color:#000>}</span>
</span></span><span style=display:flex><span><span style=color:#177500>//肯定最快
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>b</span> <span style=color:#a90d91>=</span> <span style=color:#a90d91>new</span> <span style=color:#3f6e75>Array</span><span style=color:#000>[(</span><span style=color:#a90d91>Int</span>, <span style=color:#a90d91>String</span><span style=color:#000>)](</span><span style=color:#000>days</span><span style=color:#000>.</span><span style=color:#000>length</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>var</span> <span style=color:#000>i</span> <span style=color:#a90d91>=</span> <span style=color:#1c01ce>0</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>while</span> <span style=color:#000>(</span><span style=color:#000>i</span> <span style=color:#000>&lt;</span> <span style=color:#000>days</span><span style=color:#000>.</span><span style=color:#000>length</span><span style=color:#000>)</span> <span style=color:#000>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>b</span><span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>)</span> <span style=color:#a90d91>=</span> <span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>,</span> <span style=color:#000>days</span><span style=color:#000>(</span><span style=color:#000>i</span><span style=color:#000>))</span>
</span></span><span style=display:flex><span>  <span style=color:#000>i</span> <span style=color:#000>+=</span> <span style=color:#1c01ce>1</span>
</span></span><span style=display:flex><span><span style=color:#000>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//filter
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>days</span><span style=color:#000>.</span><span style=color:#000>filter</span><span style=color:#000>(</span><span style=color:#000>day</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>day</span><span style=color:#000>.</span><span style=color:#000>length</span> <span style=color:#000>&gt;</span> <span style=color:#1c01ce>4</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//map
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#3f6e75>Array</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>,</span> <span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>4</span><span style=color:#000>,</span> <span style=color:#1c01ce>5</span><span style=color:#000>).</span><span style=color:#000>map</span><span style=color:#000>(</span><span style=color:#000>x</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>x</span> <span style=color:#000>*</span> <span style=color:#000>x</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//sort
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#3f6e75>Array</span><span style=color:#000>(</span><span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>6</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>,</span> <span style=color:#1c01ce>0</span><span style=color:#000>,</span> <span style=color:#1c01ce>8</span><span style=color:#000>,</span> <span style=color:#1c01ce>5</span><span style=color:#000>).</span><span style=color:#000>sortWith</span><span style=color:#000>((</span><span style=color:#000>e1</span><span style=color:#000>,</span> <span style=color:#000>e2</span><span style=color:#000>)</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>e1</span> <span style=color:#000>&lt;</span> <span style=color:#000>e2</span><span style=color:#000>)</span> <span style=color:#177500>//小的在前
</span></span></span><span style=display:flex><span><span style=color:#177500>//reduce，下面的会提示使用 sum,
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#3f6e75>Array</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>,</span> <span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>4</span><span style=color:#000>,</span> <span style=color:#1c01ce>5</span><span style=color:#000>).</span><span style=color:#000>reduce</span><span style=color:#000>((</span><span style=color:#000>e1</span><span style=color:#000>,</span> <span style=color:#000>e2</span><span style=color:#000>)</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>e1</span> <span style=color:#000>+</span> <span style=color:#000>e2</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//不定长数组
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>import</span> <span style=color:#000>scala.collection.mutable.ArrayBuffer</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>val</span> <span style=color:#000>arr</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>ArrayBuffer</span><span style=color:#000>[</span><span style=color:#a90d91>Int</span><span style=color:#000>]()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//tuple
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>oneAndTwo</span> <span style=color:#a90d91>=</span> <span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>val</span> <span style=color:#000>oneAndTwo1</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>Tuple2</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//Pair is alias of Tuple2
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>oneAndTwo2</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>Pair</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;two&#34;</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>val</span> <span style=color:#000>oneAndTwo3</span> <span style=color:#a90d91>=</span> <span style=color:#1c01ce>1</span> <span style=color:#000>-&gt;</span> <span style=color:#1c01ce>2</span>
</span></span><span style=display:flex><span><span style=color:#177500>//访问元素下标是从 1 开始，这是因为 tuple 里面每个元素类型不一样，为了能够和 list 等区分开
</span></span></span><span style=display:flex><span><span style=color:#177500>//使用了类似 Haskell/ML 的习惯
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>two</span> <span style=color:#a90d91>=</span> <span style=color:#000>oneAndTwo</span><span style=color:#000>.</span><span style=color:#000>_2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//option
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>emptyOpt</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>Option</span><span style=color:#000>[</span><span style=color:#a90d91>Int</span><span style=color:#000>]</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>None</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>val</span> <span style=color:#000>fullOpt</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>Option</span><span style=color:#000>[</span><span style=color:#a90d91>Int</span><span style=color:#000>]</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>Some</span><span style=color:#000>(</span><span style=color:#1c01ce>42</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#000>emptyOpt</span> <span style=color:#a90d91>match</span> <span style=color:#000>{</span>
</span></span><span style=display:flex><span>  <span style=color:#a90d91>case</span> <span style=color:#3f6e75>Some</span><span style=color:#000>(</span><span style=color:#000>value</span><span style=color:#000>)</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>println</span><span style=color:#000>(</span><span style=color:#000>value</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span>  <span style=color:#a90d91>case</span> <span style=color:#3f6e75>None</span> <span style=color:#a90d91>=&gt;</span> <span style=color:#000>println</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Empty&#34;</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#000>}</span>
</span></span><span style=display:flex><span><span style=color:#000>fullOpt</span><span style=color:#000>.</span><span style=color:#000>get</span> <span style=color:#177500>//42
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>emptyOpt</span><span style=color:#000>.</span><span style=color:#000>isEmpty</span> <span style=color:#177500>//true
</span></span></span><span style=display:flex><span><span style=color:#177500></span>
</span></span><span style=display:flex><span><span style=color:#177500>//either
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>def</span> <span style=color:#000>divide</span><span style=color:#000>(</span><span style=color:#000>a</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>Double</span><span style=color:#000>,</span> <span style=color:#000>b</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>Double</span><span style=color:#000>)</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>Either</span><span style=color:#000>[</span><span style=color:#a90d91>String</span>, <span style=color:#a90d91>Double</span><span style=color:#000>]</span> <span style=color:#a90d91>=</span> <span style=color:#000>{</span>
</span></span><span style=display:flex><span>  <span style=color:#a90d91>if</span> <span style=color:#000>(</span><span style=color:#000>b</span> <span style=color:#000>==</span> <span style=color:#1c01ce>0.0</span><span style=color:#000>)</span> <span style=color:#3f6e75>Left</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Division by zero&#34;</span><span style=color:#000>)</span> <span style=color:#a90d91>else</span> <span style=color:#3f6e75>Right</span><span style=color:#000>(</span><span style=color:#000>a</span> <span style=color:#000>/</span> <span style=color:#000>b</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#000>}</span>
</span></span><span style=display:flex><span><span style=color:#000>divide</span><span style=color:#000>(</span><span style=color:#1c01ce>4</span><span style=color:#000>,</span> <span style=color:#1c01ce>0</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>def</span> <span style=color:#000>either</span><span style=color:#000>(</span><span style=color:#000>flag</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>Boolean</span><span style=color:#000>)</span><span style=color:#a90d91>:</span> <span style=color:#a90d91>Either</span><span style=color:#000>[</span><span style=color:#a90d91>String</span>, <span style=color:#a90d91>List</span><span style=color:#000>[</span><span style=color:#a90d91>Int</span><span style=color:#000>]]</span> <span style=color:#a90d91>=</span> <span style=color:#000>{</span>
</span></span><span style=display:flex><span>  <span style=color:#a90d91>if</span> <span style=color:#000>(</span><span style=color:#000>flag</span><span style=color:#000>)</span> <span style=color:#3f6e75>Right</span><span style=color:#000>(</span><span style=color:#3f6e75>List</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>,</span> <span style=color:#1c01ce>3</span><span style=color:#000>))</span>
</span></span><span style=display:flex><span>  <span style=color:#a90d91>else</span> <span style=color:#3f6e75>Left</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;Wrong&#34;</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#000>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>val</span> <span style=color:#000>content</span> <span style=color:#a90d91>=</span> <span style=color:#000>either</span><span style=color:#000>(</span><span style=color:#a90d91>true</span><span style=color:#000>).</span><span style=color:#000>right</span><span style=color:#000>.</span><span style=color:#000>map</span><span style=color:#000>(</span><span style=color:#a90d91>_</span><span style=color:#000>.</span><span style=color:#000>filter</span><span style=color:#000>(</span><span style=color:#a90d91>_</span> <span style=color:#000>&gt;</span> <span style=color:#1c01ce>0</span><span style=color:#000>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//cast
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toArray</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toBuffer</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toList</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>((</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>)).</span><span style=color:#000>toMap</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toStream</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toString</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toVector</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toTraversable</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toIndexedSeq</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toIterable</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Set</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toSeq</span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#1c01ce>1</span><span style=color:#000>).</span><span style=color:#000>toSet</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500>//zip, zipAll, zipWithIndex, unzip
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#c41a16>&#34;abcde&#34;</span> <span style=color:#000>zip</span> <span style=color:#1c01ce>1.</span><span style=color:#000>to</span><span style=color:#000>(</span><span style=color:#1c01ce>5</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//zipAll:第二个参数是调用者元素缺失使用的默认值，第三个参数是第一个实参不够长的默认值
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#c41a16>&#34;abcde&#34;</span><span style=color:#000>.</span><span style=color:#000>zipAll</span><span style=color:#000>(</span><span style=color:#1c01ce>1.</span><span style=color:#000>to</span><span style=color:#000>(</span><span style=color:#1c01ce>2</span><span style=color:#000>),</span> <span style=color:#c41a16>&#34;caller&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;arg&#34;</span><span style=color:#000>)</span>
</span></span><span style=display:flex><span><span style=color:#177500>//尝试自己实现一个 zipAll?
</span></span></span><span style=display:flex><span><span style=color:#177500>//
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#c41a16>&#34;abcde&#34;</span> <span style=color:#000>zipWithIndex</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#3f6e75>Seq</span><span style=color:#000>((</span><span style=color:#1c01ce>1</span><span style=color:#000>,</span> <span style=color:#1c01ce>2</span><span style=color:#000>),</span> <span style=color:#000>(</span><span style=color:#1c01ce>3</span><span style=color:#000>,</span> <span style=color:#1c01ce>4</span><span style=color:#000>),</span> <span style=color:#000>(</span><span style=color:#1c01ce>5</span><span style=color:#000>,</span> <span style=color:#1c01ce>6</span><span style=color:#000>))</span> <span style=color:#000>unzip</span>
</span></span><span style=display:flex><span><span style=color:#177500>//
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#a90d91>val</span> <span style=color:#000>s</span> <span style=color:#a90d91>=</span> <span style=color:#3f6e75>Seq</span><span style=color:#000>(</span><span style=color:#c41a16>&#34;a&#34;</span><span style=color:#000>,</span> <span style=color:#c41a16>&#34;b&#34;</span><span style=color:#000>)</span>
</span></span></code></pre></div><h2 id=scala-213-collection>scala 2.13 collection</h2><p>基本重写了。参考这两个文档：<br><a href=https://docs.scala-lang.org/overviews/core/collections-migration-213.html>collections migration 2.13</a><br><a href=https://docs.scala-lang.org/overviews/core/architecture-of-scala-213-collections.html>the architecture of scala 2.13’s collections</a></p><nav class="post-nav fullwidth"><span>&larr; <a href=../../post/devops-maturity-model-checklist/>DevOps 能力成熟度模型</a></span>
<span class=post-nav-next><a href=../../post/frontend-assets-optimize-gtmetrix/>使用 GTmetrix 对前端静态资源图片优化[翻译]</a> &rarr;</span></nav></div><footer class=small><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/fix-toc.min.js defer></script><link rel=stylesheet href=//cdn.jsdelivr.net/gh/rstudio/markdown/inst/resources/prism-xcode.css><script src=//cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js defer></script><script src=//cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/copy-button.min.js defer></script><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@xiee/utils/css/copy-button.min.css><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/heading-anchor.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/fullwidth.min.js defer></script><hr><p class=nav-bottom><span><a href=https://zhi.moe>xdh</a> © 2024</span>
<span class=menu-bottom><a href=../../categories/>分类</a> <a href=../../tags/>标签</a>
<a href=../../post/index.xml type=application/rss+xml title="RSS feed">订阅</a>
<a href=#>回到顶部</a></span></p></footer></body></html>