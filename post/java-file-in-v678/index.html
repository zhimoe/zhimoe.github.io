<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Java 6/7/8 中文件读写 - 新街记事</title>
<meta property="og:title" content="Java 6/7/8 中文件读写 - 新街记事"><meta name=twitter:card content="summary"><meta property="description" content="如何在 Java 中读写文件，这里保留 Java6/7 版本，但是你永远不应该使用它们，优先使用 Path、Files、Paths 三个类。
资料：Reading and writing text files
[&amp;hellip;] 不要用 File 对象，改用 Path 对象，该对象既表示文件路径，也表示文件文本（应该认为文件也是路径的一部分），对于以前的 File， &amp;hellip;"><meta property="og:description" content="如何在 Java 中读写文件，这里保留 Java6/7 版本，但是你永远不应该使用它们，优先使用 Path、Files、Paths 三个类。
资料：Reading and writing text files
[&amp;hellip;] 不要用 File 对象，改用 Path 对象，该对象既表示文件路径，也表示文件文本（应该认为文件也是路径的一部分），对于以前的 File， &amp;hellip;"><link rel=stylesheet href=../../css/style.css><link rel=stylesheet href=../../css/fonts.css><link rel=stylesheet href=../../css/custom.css></head><body class="single post"><div class=crop-h></div><div class=crop-v></div><div class=crop-c></div><nav class="nav-top small"><div class=logo><a href=../../>新街记事</a></div><div class=menu><span class=active><a href=../../post/>博客</a></span>
<span><a href=../../categories/%E7%BC%96%E7%A8%8B/>编程</a></span>
<span><a href=../../categories/%E7%BF%BB%E8%AF%91/>翻译</a></span>
<span><a href=../../categories/%E9%9A%8F%E6%83%B3/>随想</a></span>
<span><a href=../../search/>搜索</a></span></div></nav><div class=article-meta><h1 class=title>Java 6/7/8 中文件读写</h1><h3 class=meta-line><span><span class=date>2016-02-01</span>
</span><span class=term><a href=../../categories/%E7%BC%96%E7%A8%8B/ class=term-cat>编程</a>
<a href=../../tags/java/ class=term-tag>#java </a><a href=../../tags/code/ class=term-tag>#code</a></span></h3></div><div class=main><nav id=TableOfContents><ul><li><a href=#java8-最佳实践>Java8 最佳实践</a></li><li><a href=#read-file-to-string-in-java-678>read file to string in java 6/7/8</a></li><li><a href=#java-8-file-io-demo>java 8 file io demo</a></li></ul></nav><p>如何在 Java 中读写文件，这里保留 Java6/7 版本，但是你永远不应该使用它们，优先使用 Path、Files、Paths 三个类。<br>资料：<a href="http://www.javapractices.com/topic/TopicAction.do?Id=42">Reading and writing text files</a></p><h2 id=java8-最佳实践>Java8 最佳实践</h2><p>不要用 File 对象，改用 Path 对象，该对象既表示文件路径，也表示文件文本（应该认为文件也是路径的一部分），对于以前的 File，可以 File.toPath() 得到一个 Path 对象。<br>Files 是一个静态类，操作文件内容.Paths 是静态工具类，操作文件路径，例如拼接文件路径，以前要使用平台无关的分隔符表示：File.pathSeparator、File.separator.<br>例如，构建一个文件对象：<code>Path path = Paths.get("~/test/", "foo", "bar", "a.txt");</code></p><h2 id=read-file-to-string-in-java-678>read file to string in java 6/7/8</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a90d91>package</span> <span style=color:#000>angus.java.interview</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.io.BufferedReader</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.io.FileInputStream</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.io.IOException</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.io.InputStream</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.io.InputStreamReader</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.nio.charset.StandardCharsets</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.nio.file.Files</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>import</span> <span style=color:#000>java.nio.file.Paths</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>public</span> <span style=color:#a90d91>class</span> <span style=color:#3f6e75>FileToStringJava678</span> {
</span></span><span style=display:flex><span>	<span style=color:#a90d91>public</span> <span style=color:#a90d91>static</span> <span style=color:#a90d91>void</span> <span style=color:#000>main</span>(<span style=color:#000>String</span><span style=color:#000>[]</span> <span style=color:#000>args</span>) <span style=color:#a90d91>throws</span> <span style=color:#000>IOException</span> {
</span></span><span style=display:flex><span>		<span style=color:#177500>// How to read file into String before Java 7</span>
</span></span><span style=display:flex><span>		<span style=color:#000>InputStream</span> <span style=color:#000>is</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileInputStream</span>(<span style=color:#c41a16>&#34;filetoStringjava678.txt&#34;</span>);
</span></span><span style=display:flex><span>		<span style=color:#000>BufferedReader</span> <span style=color:#000>buf</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>BufferedReader</span>(<span style=color:#a90d91>new</span> <span style=color:#000>InputStreamReader</span>(<span style=color:#000>is</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>line</span> <span style=color:#000>=</span> <span style=color:#000>buf</span>.<span style=color:#836c28>readLine</span>();
</span></span><span style=display:flex><span>		<span style=color:#000>StringBuilder</span> <span style=color:#000>sb</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>StringBuilder</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a90d91>while</span> (<span style=color:#000>line</span> <span style=color:#000>!=</span> <span style=color:#a90d91>null</span>) {
</span></span><span style=display:flex><span>			<span style=color:#000>sb</span>.<span style=color:#836c28>append</span>(<span style=color:#000>line</span>).<span style=color:#836c28>append</span>(<span style=color:#c41a16>&#34;\n&#34;</span>);
</span></span><span style=display:flex><span>			<span style=color:#000>line</span> <span style=color:#000>=</span> <span style=color:#000>buf</span>.<span style=color:#836c28>readLine</span>();
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>fileAsString</span> <span style=color:#000>=</span> <span style=color:#000>sb</span>.<span style=color:#836c28>toString</span>();
</span></span><span style=display:flex><span>		<span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Contents (before Java 7) : &#34;</span> <span style=color:#000>+</span> <span style=color:#000>fileAsString</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#177500>// Reading file into Stirng in one line in JDK 7 with using proper character encoding</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>fileString</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>String</span>(<span style=color:#000>Files</span>.<span style=color:#836c28>readAllBytes</span>(<span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#c41a16>&#34;filetoStringjava678.txt&#34;</span>)),
</span></span><span style=display:flex><span>				<span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>);
</span></span><span style=display:flex><span>		<span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Contents (Java 7 with character encoding ) : &#34;</span> <span style=color:#000>+</span> <span style=color:#000>fileString</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#177500>//java 7 按行读取</span>
</span></span><span style=display:flex><span>        <span style=color:#000>BufferedReader</span> <span style=color:#000>br</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>BufferedReader</span>(<span style=color:#a90d91>new</span> <span style=color:#000>FileReader</span>(<span style=color:#000>file</span>));
</span></span><span style=display:flex><span>        <span style=color:#000>String</span> <span style=color:#000>line</span>;
</span></span><span style=display:flex><span>        <span style=color:#a90d91>while</span>((<span style=color:#000>line</span> <span style=color:#000>=</span> <span style=color:#000>br</span>.<span style=color:#836c28>readLine</span>()) <span style=color:#000>!=</span> <span style=color:#a90d91>null</span>) {
</span></span><span style=display:flex><span>            <span style=color:#177500>// do something with line.</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#177500>//java 8 按行读取</span>
</span></span><span style=display:flex><span>        <span style=color:#000>String</span> <span style=color:#000>fileName</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;c:/lines.txt&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#a90d91>try</span> (<span style=color:#000>Stream</span><span style=color:#000>&lt;</span><span style=color:#000>String</span><span style=color:#000>&gt;</span> <span style=color:#000>stream</span> <span style=color:#000>=</span> <span style=color:#000>Files</span>.<span style=color:#836c28>lines</span>(<span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#000>fileName</span>))) {
</span></span><span style=display:flex><span>            <span style=color:#000>stream</span>.<span style=color:#836c28>forEach</span>(<span style=color:#000>System</span>.<span style=color:#836c28>out</span>::<span style=color:#000>println</span>);<span style=color:#177500>//or other thing you do with stream</span>
</span></span><span style=display:flex><span>        } <span style=color:#a90d91>catch</span> (<span style=color:#000>IOException</span> <span style=color:#000>e</span>) {
</span></span><span style=display:flex><span>            <span style=color:#000>e</span>.<span style=color:#836c28>printStackTrace</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>		<span style=color:#177500>// It&#39;s even easier in Java 8</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Files</span>.<span style=color:#836c28>lines</span>(<span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#c41a16>&#34;filetoStringjava678.txt&#34;</span>), <span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>).<span style=color:#836c28>forEach</span>(<span style=color:#000>System</span>.<span style=color:#836c28>out</span>::<span style=color:#000>println</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=java-8-file-io-demo>java 8 file io demo</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a90d91>public</span> <span style=color:#a90d91>class</span> <span style=color:#3f6e75>Java8IO</span> {
</span></span><span style=display:flex><span>    <span style=color:#a90d91>public</span> <span style=color:#a90d91>static</span> <span style=color:#a90d91>void</span> <span style=color:#000>main</span>(<span style=color:#000>String</span><span style=color:#000>[]</span> <span style=color:#000>args</span>) <span style=color:#a90d91>throws</span> <span style=color:#000>IOException</span> {
</span></span><span style=display:flex><span>        <span style=color:#177500>//读取所有字节：</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Path</span> <span style=color:#000>path</span> <span style=color:#000>=</span> <span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#c41a16>&#34;alice.txt&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#000>String</span> <span style=color:#000>content</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>String</span>(<span style=color:#000>Files</span>.<span style=color:#836c28>readAllBytes</span>(<span style=color:#000>path</span>), <span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>);
</span></span><span style=display:flex><span>        <span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Characters: &#34;</span> <span style=color:#000>+</span> <span style=color:#000>content</span>.<span style=color:#836c28>length</span>());
</span></span><span style=display:flex><span>        <span style=color:#177500>// 读取所有行：</span>
</span></span><span style=display:flex><span>        <span style=color:#000>List</span><span style=color:#000>&lt;</span><span style=color:#000>String</span><span style=color:#000>&gt;</span> <span style=color:#000>lines</span> <span style=color:#000>=</span> <span style=color:#000>Files</span>.<span style=color:#836c28>readAllLines</span>(<span style=color:#000>path</span>, <span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>);
</span></span><span style=display:flex><span>        <span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Lines: &#34;</span> <span style=color:#000>+</span> <span style=color:#000>lines</span>.<span style=color:#836c28>size</span>());
</span></span><span style=display:flex><span>        <span style=color:#177500>// JAVA 8 延迟处理：</span>
</span></span><span style=display:flex><span>        <span style=color:#a90d91>try</span> (<span style=color:#000>Stream</span><span style=color:#000>&lt;</span><span style=color:#000>String</span><span style=color:#000>&gt;</span> <span style=color:#000>lineStream</span> <span style=color:#000>=</span> <span style=color:#000>Files</span>.<span style=color:#836c28>lines</span>(<span style=color:#000>path</span>, <span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Average line length: &#34;</span> <span style=color:#000>+</span>  <span style=color:#000>lineStream</span>.<span style=color:#836c28>mapToInt</span>(<span style=color:#000>String</span>::<span style=color:#000>length</span>).<span style=color:#836c28>average</span>().<span style=color:#836c28>orElse</span>(<span style=color:#000>0</span>));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#177500>// 按单词读取：</span>
</span></span><span style=display:flex><span>        <span style=color:#a90d91>try</span> (<span style=color:#000>Scanner</span> <span style=color:#000>in</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>Scanner</span>(<span style=color:#000>path</span>, <span style=color:#c41a16>&#34;UTF-8&#34;</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#000>in</span>.<span style=color:#836c28>useDelimiter</span>(<span style=color:#c41a16>&#34;\\PL+&#34;</span>);<span style=color:#177500>//？</span>
</span></span><span style=display:flex><span>            <span style=color:#a90d91>int</span> <span style=color:#000>words</span> <span style=color:#000>=</span> <span style=color:#000>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#a90d91>while</span> (<span style=color:#000>in</span>.<span style=color:#836c28>hasNext</span>()) {
</span></span><span style=display:flex><span>                <span style=color:#000>in</span>.<span style=color:#836c28>next</span>();
</span></span><span style=display:flex><span>                <span style=color:#000>words</span><span style=color:#000>++</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Words: &#34;</span> <span style=color:#000>+</span> <span style=color:#000>words</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#177500>// 读取一个网页：   </span>
</span></span><span style=display:flex><span>        <span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>URL</span>(<span style=color:#c41a16>&#34;https://horstmann.com/index.html&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a90d91>try</span> (<span style=color:#000>BufferedReader</span> <span style=color:#000>reader</span>
</span></span><span style=display:flex><span>                <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>BufferedReader</span>(<span style=color:#a90d91>new</span> <span style=color:#000>InputStreamReader</span>(<span style=color:#000>url</span>.<span style=color:#836c28>openStream</span>()))) {
</span></span><span style=display:flex><span>            <span style=color:#000>Stream</span><span style=color:#000>&lt;</span><span style=color:#000>String</span><span style=color:#000>&gt;</span> <span style=color:#000>lineStream</span> <span style=color:#000>=</span> <span style=color:#000>reader</span>.<span style=color:#836c28>lines</span>();<span style=color:#177500>////!!!! BufferedReader TO Stream</span>
</span></span><span style=display:flex><span>            <span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Average line length: &#34;</span> <span style=color:#000>+</span> 
</span></span><span style=display:flex><span>				<span style=color:#000>lineStream</span>.<span style=color:#836c28>mapToInt</span>(<span style=color:#000>String</span>::<span style=color:#000>length</span>).<span style=color:#836c28>average</span>().<span style=color:#836c28>orElse</span>(<span style=color:#000>0</span>));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#177500>// PrintWriter 向文本写文件：</span>
</span></span><span style=display:flex><span>        <span style=color:#000>path</span> <span style=color:#000>=</span> <span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#c41a16>&#34;hello.txt&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a90d91>try</span> (<span style=color:#000>PrintWriter</span> <span style=color:#000>out</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>PrintWriter</span>(<span style=color:#000>Files</span>.<span style=color:#836c28>newBufferedWriter</span>(<span style=color:#000>path</span>, <span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>))) {
</span></span><span style=display:flex><span>            <span style=color:#000>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Hello&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#177500>// Files.write 向文本写文件：</span>
</span></span><span style=display:flex><span>        <span style=color:#000>content</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;World\n&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#000>Files</span>.<span style=color:#836c28>write</span>(<span style=color:#000>path</span>, <span style=color:#000>content</span>.<span style=color:#836c28>getBytes</span>(<span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>), <span style=color:#000>StandardOpenOption</span>.<span style=color:#836c28>APPEND</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#177500>// 多行写入</span>
</span></span><span style=display:flex><span>        <span style=color:#000>String</span> <span style=color:#000>fileName</span> <span style=color:#000>=</span> <span style=color:#c41a16>&#34;file.txt&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#000>Path</span> <span style=color:#000>path</span> <span style=color:#000>=</span> <span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#c41a16>&#34;file1.txt&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#000>List</span><span style=color:#000>&lt;</span><span style=color:#000>String</span><span style=color:#000>&gt;</span> <span style=color:#000>list</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>ArrayList</span><span style=color:#000>&lt;&gt;</span>();
</span></span><span style=display:flex><span>        <span style=color:#a90d91>try</span> (<span style=color:#000>Stream</span><span style=color:#000>&lt;</span><span style=color:#000>String</span><span style=color:#000>&gt;</span> <span style=color:#000>lines</span> <span style=color:#000>=</span> <span style=color:#000>Files</span>.<span style=color:#836c28>lines</span>(<span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#000>fileName</span>))) {
</span></span><span style=display:flex><span>            <span style=color:#000>lines</span>.<span style=color:#836c28>forEach</span>(<span style=color:#000>list</span>::<span style=color:#000>add</span>);
</span></span><span style=display:flex><span>            <span style=color:#000>Files</span>.<span style=color:#836c28>write</span>(<span style=color:#000>path</span>, <span style=color:#000>list</span>, <span style=color:#000>StandardCharsets</span>.<span style=color:#836c28>UTF_8</span>);
</span></span><span style=display:flex><span>        } <span style=color:#a90d91>catch</span> (<span style=color:#000>IOException</span> <span style=color:#000>e</span>) {
</span></span><span style=display:flex><span>            <span style=color:#000>e</span>.<span style=color:#836c28>printStackTrace</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#177500>// 打印错误栈：  </span>
</span></span><span style=display:flex><span>        <span style=color:#000>StringWriter</span> <span style=color:#000>writer</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>StringWriter</span>();
</span></span><span style=display:flex><span>        <span style=color:#000>Throwable</span> <span style=color:#000>throwable</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>IllegalStateException</span>();
</span></span><span style=display:flex><span>        <span style=color:#000>throwable</span>.<span style=color:#836c28>printStackTrace</span>(<span style=color:#a90d91>new</span> <span style=color:#000>PrintWriter</span>(<span style=color:#000>writer</span>));
</span></span><span style=display:flex><span>        <span style=color:#000>String</span> <span style=color:#000>stackTrace</span> <span style=color:#000>=</span> <span style=color:#000>writer</span>.<span style=color:#836c28>toString</span>();
</span></span><span style=display:flex><span>        <span style=color:#000>System</span>.<span style=color:#836c28>out</span>.<span style=color:#836c28>println</span>(<span style=color:#c41a16>&#34;Stack trace: &#34;</span> <span style=color:#000>+</span> <span style=color:#000>stackTrace</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#177500>// 输入流保存到文件：</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Files</span>.<span style=color:#836c28>copy</span>(<span style=color:#000>inputStream</span>,<span style=color:#000>filepath</span>,<span style=color:#000>StandardCopyOption</span>.<span style=color:#836c28>REPLACE_EXISTING</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#177500>// 直接将 url 中的 pdf 保存下来：</span>
</span></span><span style=display:flex><span>        <span style=color:#177500>// 适用于任何二进制文件：</span>
</span></span><span style=display:flex><span>        <span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>URL</span>(<span style=color:#c41a16>&#34;http://www.cninfo.com.cn/1202417936.PDF&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a90d91>try</span> (<span style=color:#000>InputStream</span> <span style=color:#000>in</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>BufferedInputStream</span>(<span style=color:#000>url</span>.<span style=color:#836c28>openStream</span>())) {
</span></span><span style=display:flex><span>            <span style=color:#000>Files</span>.<span style=color:#836c28>copy</span>(<span style=color:#000>in</span>, <span style=color:#000>Paths</span>.<span style=color:#836c28>get</span>(<span style=color:#000>url</span>.<span style=color:#836c28>getFile</span>().<span style=color:#836c28>substring</span>(<span style=color:#000>1</span>)),<span style=color:#000>StandardCopyOption</span>.<span style=color:#836c28>REPLACE_EXISTING</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#177500>// url.getFile().substring(1) 去掉起始地斜杠符</span>
</span></span><span style=display:flex><span>        <span style=color:#177500>// copy() 有三种形式</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#177500>// 还有一种方式用于 jdk7 之前：</span>
</span></span><span style=display:flex><span>        <span style=color:#000>URL</span> <span style=color:#000>website</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>URL</span>(<span style=color:#c41a16>&#34;XXX.pdf&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#000>ReadableByteChannel</span> <span style=color:#000>rbc</span> <span style=color:#000>=</span> <span style=color:#000>Channels</span>.<span style=color:#836c28>newChannel</span>(<span style=color:#000>website</span>.<span style=color:#836c28>openStream</span>());
</span></span><span style=display:flex><span>        <span style=color:#000>FileOutputStream</span> <span style=color:#000>fos</span> <span style=color:#000>=</span> <span style=color:#a90d91>new</span> <span style=color:#000>FileOutputStream</span>(<span style=color:#000>url</span>.<span style=color:#836c28>getFile</span>().<span style=color:#836c28>substring</span>(<span style=color:#000>1</span>));
</span></span><span style=display:flex><span>        <span style=color:#000>fos</span>.<span style=color:#836c28>getChannel</span>().<span style=color:#836c28>transferFrom</span>(<span style=color:#000>rbc</span>, <span style=color:#000>0</span>, <span style=color:#000>Long</span>.<span style=color:#836c28>MAX_VALUE</span>);
</span></span><span style=display:flex><span>        <span style=color:#177500>// FileChannel 的抽象方法 abstract long	transferFrom(ReadableByteChannel src, long position, long count) </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><nav class="post-nav fullwidth"><span>&larr; <a href=../../post/java-io-basic/>IO-Java-Stream-Write-Reader</a></span>
<span><a href=../../post/java-aop-example/>Java AOP example</a> &rarr;</span></nav></div><footer class=small><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/fix-toc.min.js defer></script><link rel=stylesheet href=//cdn.jsdelivr.net/gh/rstudio/markdown/inst/resources/prism-xcode.css><script src=//cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js defer></script><script src=//cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/copy-button.min.js defer></script><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@xiee/utils/css/copy-button.min.css><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/key-buttons.min.js defer></script><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@xiee/utils/css/key-buttons.min.css><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/heading-anchor.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js defer></script><script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/fullwidth.min.js defer></script><hr><p class=nav-bottom><span><a href=https://zhi.moe>xdh</a> © 2024</span>
<span class=menu-bottom><a href=../../categories/>分类</a> <a href=../../tags/>标签</a>
<a href=../../post/index.xml type=application/rss+xml title="RSS feed">订阅</a>
<a href=#>回到顶部</a></span></p></footer></body></html>